//var _0x1dd3=['chart','scatter','GRAFICA\x20VESTER','EJE\x20X','EJE\x20Y','<b>{series.name}</b><br>','.highcharts-root','width','height','requestAnimationFrame','mozRequestAnimationFrame','webkitRequestAnimationFrame','msRequestAnimationFrame','.highcharts-yaxis-grid\x20path:first-child','\x2052\x20L\x20','attr','stroke','blue','stroke-width','#container','prepend','<span\x20id=\x22lineaTerror\x22></span>','2px','absolute','PuntosCriticos','Criterio','Pasivos','Criticos','Indiferentes','Activos','puntoAlto','name','Punto\x20Critico:\x20','Punto\x20Critico','HabilitarEnviar','#Calificar','Guardar','Debe\x20realizar\x20la\x20matriz\x20de\x20Vester','Registro\x20Exitoso','/Menu','Regresar','.notify','MatrizController','$scope','$location','MatrizService','$routeParams','$sce','#Panel2','hide','#problematicaCampo','removeAttr','disabled','#ProblematicaTexto','#TituloProblema','Problemas','DatosProyecto','proyecto','datos','SeriesPuntos','getElementById','audio-player','pause','success','DatosMatriz','matriz','DetalleMat','ProblemaGeneral','#problemasMatriz','show','#BtnGuardar','modal','static','#ModalOmitir','OmitirMatriz','url','.modal-backdrop','remove','AgregarCampos','length','push','La\x20cantidad\x20de\x20problemas\x20a\x20ingresar\x20debe\x20ser\x20menor\x20de\x2020','log','Ingrese\x20el\x20problema\x20general','#238276','25%','Elija\x20la\x20cantidad\x20de\x20problemas\x20a\x20evaluar','EliminarCampos','mostrar','ProblemasCalificar','each','Problema','Debe\x20llenar\x20todos\x20los\x20campos','totalProblemas','inArray','ProblemaComparante','#comparar\x20li:nth-child(1)','#Problematicas','#mostrar','#agregarProblemas','#influeniciaTitulo','css','block','sumaEjeX','Datos','sumaEjeY','Puntos','#ModalConfirmar','ConfirmarCalificacion','splice','EjeX','map','EjeY','rgba(0,0,255,0.6)','EvaluacionCriterios','grafica','#personaje','#grafica','#problema'];(function(_0x3eb213,_0x118b9f){var _0x24541a=function(_0x40cd94){while(--_0x40cd94){_0x3eb213['push'](_0x3eb213['shift']());}};_0x24541a(++_0x118b9f);}(_0x1dd3,0x118));var _0x165c=function(_0x70c6d9,_0x3c0edc){_0x70c6d9=_0x70c6d9-0x0;var _0x177424=_0x1dd3[_0x70c6d9];return _0x177424;};ManualApp['controller'](_0x165c('0x0'),[_0x165c('0x1'),'$rootScope',_0x165c('0x2'),_0x165c('0x3'),'ArbolProblemaService',_0x165c('0x4'),_0x165c('0x5'),function(_0xfb4fbb,_0xe30eaf,_0x5e69c0,_0x4c3e01,_0x179ee0,_0x18a202,_0x5569c2){$(_0x165c('0x6'))[_0x165c('0x7')]();$(_0x165c('0x8'))[_0x165c('0x9')](_0x165c('0xa'));$(_0x165c('0xb'))[_0x165c('0x7')]();$(_0x165c('0xc'))[_0x165c('0x7')]();_0xfb4fbb[_0x165c('0xd')]=[{'Problema':'','EjeX':'','EjeY':'','Criterio':''}];_0xfb4fbb[_0x165c('0xe')]={'IdProyecto':_0xe30eaf[_0x165c('0xf')][_0x165c('0x10')]['id'],'IdMatriz':'','ProblemaGeneral':'','DetalleMat':[{'Problema':'','EjeX':'','EjeY':'','Criterio':''}]};_0xfb4fbb[_0x165c('0x11')]=[];_0xfb4fbb['PauseAudio']=function(){setTimeout(function(){var _0x5742c7=document[_0x165c('0x12')](_0x165c('0x13'));_0x5742c7[_0x165c('0x14')]();},0x3e8);};if(_0xe30eaf[_0x165c('0xf')]!=undefined){_0x4c3e01['ConsultarMatriz'](_0xe30eaf['proyecto'][_0x165c('0x10')]['id'],function(_0x3f8d50){if(_0x3f8d50[_0x165c('0x15')]){_0xfb4fbb[_0x165c('0x16')]=_0x3f8d50[_0x165c('0x17')][_0x165c('0x18')];_0xfb4fbb[_0x165c('0xe')][_0x165c('0x19')]=_0x3f8d50[_0x165c('0x17')]['ProblemaGeneral'];$(_0x165c('0x1a'))[_0x165c('0x7')]();$(_0x165c('0x6'))['show']();$('#problematicaCampo')['hide']();$('#TituloProblema')[_0x165c('0x1b')]();$(_0x165c('0x1c'))[_0x165c('0x7')]();}else{$('#ModalOmitir')[_0x165c('0x1d')]({'backdrop':_0x165c('0x1e'),'keyboard':![]});$(_0x165c('0x1f'))[_0x165c('0x1d')](_0x165c('0x1b'));}});}_0xfb4fbb[_0x165c('0x20')]=function(){_0x4c3e01[_0x165c('0x20')](_0xe30eaf[_0x165c('0xf')][_0x165c('0x10')]['id'],function(_0x4538a9){if(_0x4538a9[_0x165c('0x15')]){_0x5e69c0[_0x165c('0x21')]('/Menu');$(_0x165c('0x22'))[_0x165c('0x23')]();}});};_0xfb4fbb[_0x165c('0x24')]=function(){if(_0xfb4fbb[_0x165c('0xd')][_0x165c('0x25')]<0x19){_0xfb4fbb['Problemas'][_0x165c('0x26')]({'Problema':''});}else{alert(_0x165c('0x27'));return![];}};_0xfb4fbb['Agregar']=function(_0x174af0){console[_0x165c('0x28')](_0x174af0);if(_0xfb4fbb[_0x165c('0xe')][_0x165c('0x19')]==''){swal({'text':_0x165c('0x29'),'confirmButtonColor':_0x165c('0x2a'),'width':_0x165c('0x2b')});return;}if(_0x174af0==undefined){swal({'text':_0x165c('0x2c'),'confirmButtonColor':_0x165c('0x2a'),'width':_0x165c('0x2b')});return;}_0xfb4fbb[_0x165c('0xd')]=[{'Problema':'','EjeX':'','EjeY':'','Criterio':''}];var _0x4205f6=parseInt(_0x174af0);for(var _0x457402=0x0;_0x457402<_0x4205f6;_0x457402++){_0xfb4fbb[_0x165c('0xd')][_0x165c('0x26')]({'Problema':''});}};_0xfb4fbb[_0x165c('0x2d')]=function(_0x4b7956){if(_0xfb4fbb['Problemas'][_0x165c('0x25')]>0x1){_0xfb4fbb[_0x165c('0xd')]['splice'](_0x4b7956,0x1);}};_0xfb4fbb[_0x165c('0x2e')]=function(){_0xfb4fbb[_0x165c('0x2f')]=[];if(_0xfb4fbb[_0x165c('0xd')][_0x165c('0x25')]<0x5){alertify[_0x165c('0x15')]('La\x20cantidad\x20mínima\x20de\x20problemas\x20es\x205');return;}else{var _0x375b0d=0x0;$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0x150e21,_0x25b046){if(_0x25b046[_0x165c('0x31')]==''){_0x375b0d++;}});if(_0x375b0d!=0x0){alertify[_0x165c('0x15')](_0x165c('0x32'));return;}}_0xfb4fbb['totalProblemas']=[];$[_0x165c('0x30')](_0xfb4fbb['Problemas'],function(_0x35dfe5,_0x58d003){if(_0x35dfe5!=0x0){_0xfb4fbb[_0x165c('0x2f')]['push']({'Problema':_0x58d003[_0x165c('0x31')]});}var _0x486c41=_0x58d003[_0x165c('0x31')];_0xfb4fbb[_0x165c('0x33')][_0x165c('0x26')]({'problema':_0x486c41});});var _0x27ad23=[];$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0x2cbfcb,_0x3000a5){if($[_0x165c('0x34')](_0x3000a5[_0x165c('0x31')],_0x27ad23)===-0x1){_0x27ad23[_0x165c('0x26')](_0x3000a5['Problema']);}});if(_0x27ad23[_0x165c('0x25')]>0x0&&_0x27ad23[_0x165c('0x25')]<_0xfb4fbb[_0x165c('0xd')][_0x165c('0x25')]){swal({'text':'Ups!\x20Tienes\x20problemas\x20repetidos','confirmButtonColor':_0x165c('0x2a'),'width':_0x165c('0x2b')});return![];}_0xfb4fbb[_0x165c('0x35')]=_0xfb4fbb[_0x165c('0xd')][0x0][_0x165c('0x31')];setTimeout(function(){$(_0x165c('0x36'))[_0x165c('0x1b')]();},0x64);$(_0x165c('0x37'))['hide']();$(_0x165c('0x38'))[_0x165c('0x7')]();$(_0x165c('0x39'))['hide']();$(_0x165c('0x1a'))[_0x165c('0x7')]();$(_0x165c('0x3a'))[_0x165c('0x3b')]({'display':_0x165c('0x3c')});$(_0x165c('0x8'))[_0x165c('0x9')](_0x165c('0xa'));};var _0x552d2d=0x0;_0xfb4fbb[_0x165c('0x3d')]=0x0;_0xfb4fbb[_0x165c('0x3e')]=[];_0xfb4fbb[_0x165c('0x3f')]=[];_0xfb4fbb[_0x165c('0x40')]=[];var _0x5459c7=0x0;_0xfb4fbb['Calificar']=function(_0x3a7c8d,_0x266d01,_0x4a7821){_0x5459c7=parseInt(_0x5459c7)+parseInt(_0x266d01);_0xfb4fbb[_0x165c('0x3f')][_0x165c('0x26')](parseInt(_0x266d01));_0xfb4fbb[_0x165c('0x2f')]['splice'](_0x3a7c8d,0x1);setTimeout(function(){$('#comparar\x20li:nth-child('+(_0x3a7c8d+0x1)+')')['show']();},0x64);if(_0xfb4fbb[_0x165c('0x2f')][_0x165c('0x25')]==0x0){$(_0x165c('0x41'))[_0x165c('0x1d')]({'backdrop':_0x165c('0x1e'),'keyboard':![]});$(_0x165c('0x41'))[_0x165c('0x1d')](_0x165c('0x1b'));}};_0xfb4fbb[_0x165c('0x42')]=function(_0x11401a){if(_0x11401a==0x1){_0xfb4fbb[_0x165c('0x3d')]=_0x5459c7;}else{$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0x4b50da,_0x5aae81){if(_0x4b50da!=_0x552d2d){_0xfb4fbb['ProblemasCalificar'][_0x165c('0x26')]({'Problema':_0x5aae81[_0x165c('0x31')]});}});setTimeout(function(){$(_0x165c('0x36'))[_0x165c('0x1b')]();},0x64);return![];}_0x5459c7=0x0;_0xfb4fbb[_0x165c('0x3f')][_0x165c('0x43')](_0x552d2d,0x0,0x0);_0xfb4fbb[_0x165c('0x3e')][_0x165c('0x26')](_0xfb4fbb[_0x165c('0x3f')]);_0xfb4fbb[_0x165c('0x3f')]=[];_0xfb4fbb[_0x165c('0xd')][_0x552d2d][_0x165c('0x44')]=_0xfb4fbb[_0x165c('0x3d')];_0xfb4fbb[_0x165c('0x3d')]=0x0;_0x552d2d++;var _0x43f664=_0x552d2d+0x1;if(_0x43f664>_0xfb4fbb[_0x165c('0xd')][_0x165c('0x25')]){var _0xcf7c00=(_0x394936,_0x4fc6fa)=>_0x394936[_0x165c('0x45')]((_0x208572,_0x2e9c93)=>_0x4fc6fa[_0x2e9c93]+_0x208572);var _0x4202d9=function(_0x72cf29,_0x3a941d){return _0x72cf29+_0x3a941d;};var _0x4874af=_0xfb4fbb[_0x165c('0x3e')]['reduce'](_0xcf7c00);$[_0x165c('0x30')](_0x4874af,function(_0x537c14,_0x113ca3){_0xfb4fbb[_0x165c('0xd')][_0x537c14][_0x165c('0x46')]=_0x113ca3;});var _0x3ae986={'name':_0x165c('0xd'),'color':'rgba(0,0,0,0.0)','data':[[0x0,0x0]]};_0xfb4fbb[_0x165c('0x11')][_0x165c('0x26')](_0x3ae986);$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0x2cbe0d,_0x3379a0){var _0x1a678c={'name':_0x3379a0[_0x165c('0x31')],'color':_0x165c('0x47'),'data':[[_0x3379a0[_0x165c('0x44')],_0x3379a0[_0x165c('0x46')]]]};_0xfb4fbb['SeriesPuntos'][_0x165c('0x26')](_0x1a678c);});_0xfb4fbb[_0x165c('0x48')]();_0xfb4fbb[_0x165c('0x49')]();console[_0x165c('0x28')](_0xfb4fbb[_0x165c('0xd')]);_0x552d2d=0x0;return![];}_0xfb4fbb[_0x165c('0x35')]=_0xfb4fbb[_0x165c('0xd')][_0x552d2d][_0x165c('0x31')];$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0x43cfb3,_0x2b3033){if(_0x43cfb3!=_0x552d2d){_0xfb4fbb[_0x165c('0x2f')]['push']({'Problema':_0x2b3033[_0x165c('0x31')]});}});setTimeout(function(){$('#comparar\x20li:nth-child(1)')['show']();},0x64);};_0xfb4fbb[_0x165c('0x49')]=function(){$(_0x165c('0x4a'))[_0x165c('0x7')]();$(_0x165c('0x4b'))[_0x165c('0x1b')]();$(_0x165c('0x4c'))[_0x165c('0x7')]();$(_0x165c('0x3a'))[_0x165c('0x7')]();Highcharts[_0x165c('0x4d')]('container',{'chart':{'type':_0x165c('0x4e'),'height':0x1e0},'title':{'text':_0x165c('0x4f')},'xAxis':{'title':{'enabled':!![],'text':_0x165c('0x50')},'startOnTick':![],'endOnTick':![],'showLastLabel':!![],'allowDecimals':![]},'yAxis':{'title':{'text':_0x165c('0x51')},'startOnTick':![],'endOnTick':!![],'showLastLabel':!![],'allowDecimals':![]},'legend':{'enabled':![]},'plotOptions':{'scatter':{'marker':{'radius':0x5,'states':{'hover':{'enabled':!![],'lineColor':'rgb(100,100,100)'}}},'states':{'hover':{'marker':{'enabled':![]}}},'tooltip':{'headerFormat':_0x165c('0x52'),'pointFormat':'{point.x}\x20X,\x20{point.y}\x20Y'}}},'series':_0xfb4fbb[_0x165c('0x11')]});console[_0x165c('0x28')](_0xfb4fbb[_0x165c('0x11')]);var _0x9bef44=$(_0x165c('0x53'))[_0x165c('0x54')]()/0x2+0x1b;var _0xfa1944=$(_0x165c('0x53'))[_0x165c('0x55')]();var _0x27150b=window[_0x165c('0x56')]||window[_0x165c('0x57')]||window[_0x165c('0x58')]||window[_0x165c('0x59')];;function _0x277be0(){$(_0x165c('0x5a'))['attr']('d','M\x20'+_0x9bef44+_0x165c('0x5b')+_0x9bef44+'\x20'+(_0xfa1944-0x3c)+'')[_0x165c('0x5c')](_0x165c('0x5d'),_0x165c('0x5e'))[_0x165c('0x5c')](_0x165c('0x5f'),'2');_0x27150b(_0x277be0);}_0x27150b(_0x277be0);$(_0x165c('0x60'))[_0x165c('0x61')](_0x165c('0x62'));$('#lineaTerror')[_0x165c('0x3b')]({'width':$(_0x165c('0x53'))[_0x165c('0x54')]()-0x47+'px','height':_0x165c('0x63'),'top':_0xfa1944/0x2-0x8+'px','left':'110px','background':_0x165c('0x5e'),'z-index':'1','position':_0x165c('0x64')});$('.highcharts-button\x20,\x20.highcharts-credits')[_0x165c('0x7')]();};_0xfb4fbb[_0x165c('0x48')]=function(){var _0x4d8fdc=parseInt(_0xfb4fbb[_0x165c('0xd')][_0x165c('0x25')])*0x3-0x3;var _0x3e5ad3=0x0;var _0x5f284b=0x0;var _0x28d874=0x0;var _0x302966=0x0;$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0x9920e3,_0x498951){if(_0x498951[_0x165c('0x46')]>=_0x5f284b){_0x5f284b=_0x498951[_0x165c('0x46')];_0x302966=(parseInt(_0x5f284b)+0x1)/0x2;}if(_0x498951['EjeX']>=_0x28d874){_0x28d874=_0x498951['EjeX'];_0x3e5ad3=parseInt(_0x28d874)/0x2;}});console[_0x165c('0x28')](_0x302966);console[_0x165c('0x28')](_0x3e5ad3);_0xfb4fbb[_0x165c('0x65')]=[];$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0xd')],function(_0xef153d,_0x4c6a63){if(_0x4c6a63[_0x165c('0x44')]<=_0x3e5ad3&&_0x4c6a63[_0x165c('0x46')]>=_0x302966){_0xfb4fbb[_0x165c('0xd')][_0xef153d][_0x165c('0x66')]=_0x165c('0x67');}else if(_0x4c6a63[_0x165c('0x44')]>_0x3e5ad3&&_0x4c6a63[_0x165c('0x46')]>_0x302966){_0xfb4fbb[_0x165c('0xd')][_0xef153d]['Criterio']=_0x165c('0x68');_0xfb4fbb[_0x165c('0x65')]['push'](_0xfb4fbb[_0x165c('0xd')][_0xef153d]);}else if(_0x4c6a63[_0x165c('0x44')]<_0x3e5ad3&&_0x4c6a63[_0x165c('0x46')]<_0x302966){_0xfb4fbb[_0x165c('0xd')][_0xef153d][_0x165c('0x66')]=_0x165c('0x69');}else if(_0x4c6a63[_0x165c('0x44')]>=_0x3e5ad3&&_0x4c6a63[_0x165c('0x46')]<=_0x302966){_0xfb4fbb[_0x165c('0xd')][_0xef153d][_0x165c('0x66')]=_0x165c('0x6a');}});var _0x55054a=0x0;var _0x21577f=0x0;if(_0xfb4fbb[_0x165c('0x65')][_0x165c('0x25')]>0x0){$[_0x165c('0x30')](_0xfb4fbb['PuntosCriticos'],function(_0x365fea,_0x3a4749){var _0x2b6fce=parseInt(_0x3a4749[_0x165c('0x44')])+parseInt(_0x3a4749[_0x165c('0x46')]);_0x21577f=Math['sqrt'](_0x2b6fce);if(_0x21577f>_0x55054a){_0x55054a=_0x21577f;_0xfb4fbb[_0x165c('0x6b')]=_0x365fea;}});$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0x11')],function(_0x23c8f2,_0x566b97){if(_0x566b97[_0x165c('0x6c')]==_0xfb4fbb[_0x165c('0x65')][_0xfb4fbb[_0x165c('0x6b')]]['Problema']){var _0x2f3040={'name':_0x165c('0x6d')+_0xfb4fbb[_0x165c('0x65')][_0xfb4fbb[_0x165c('0x6b')]][_0x165c('0x31')],'color':'rgba(255,0,0,1)','data':[[_0xfb4fbb[_0x165c('0x65')][_0xfb4fbb[_0x165c('0x6b')]][_0x165c('0x44')],_0xfb4fbb[_0x165c('0x65')][_0xfb4fbb[_0x165c('0x6b')]][_0x165c('0x46')]]]};_0xfb4fbb[_0x165c('0x11')][_0x23c8f2]=_0x2f3040;}});$['each'](_0xfb4fbb[_0x165c('0xd')],function(_0x6ec80e,_0x1566e5){if(_0x1566e5['Problema']==_0xfb4fbb[_0x165c('0x65')][_0xfb4fbb[_0x165c('0x6b')]][_0x165c('0x31')]){_0xfb4fbb['Problemas'][_0x6ec80e]['Criterio']=_0x165c('0x6e');}if(_0x1566e5[_0x165c('0x66')]==_0x165c('0x68')&&_0x1566e5['Problema']!=_0xfb4fbb[_0x165c('0x65')][_0xfb4fbb[_0x165c('0x6b')]][_0x165c('0x31')]){_0xfb4fbb['Problemas'][_0x6ec80e][_0x165c('0x66')]='Activos';}});}else{var _0x55054a=0x0;$[_0x165c('0x30')](_0xfb4fbb[_0x165c('0x11')],function(_0x31774f,_0x3fd1c2){if(_0x55054a==0x0){var _0x4af833={'name':_0x165c('0x6d')+_0xfb4fbb['Problemas'][0x0][_0x165c('0x31')],'color':'rgba(255,0,0,1)','data':[[_0xfb4fbb[_0x165c('0xd')][0x0]['EjeX'],_0xfb4fbb[_0x165c('0xd')][0x0][_0x165c('0x46')]]]};_0xfb4fbb[_0x165c('0x11')][_0x31774f]=_0x4af833;_0x55054a++;}});}};_0xfb4fbb[_0x165c('0x6f')]=function(){$(_0x165c('0x70'))[_0x165c('0x5c')](_0x165c('0xa'),![]);};_0xfb4fbb[_0x165c('0x71')]=function(){_0xfb4fbb[_0x165c('0xe')]['DetalleMat']=_0xfb4fbb[_0x165c('0xd')];if(_0xfb4fbb[_0x165c('0xe')][_0x165c('0x18')][0x0][_0x165c('0x66')]==''){swal({'text':_0x165c('0x72'),'confirmButtonColor':_0x165c('0x2a'),'width':_0x165c('0x2b')});return;}waitingDialog[_0x165c('0x1b')]();_0x4c3e01[_0x165c('0x71')](_0xfb4fbb[_0x165c('0xe')],function(_0x23d932){if(_0x23d932[_0x165c('0x15')]){waitingDialog[_0x165c('0x7')]();swal({'text':_0x165c('0x73'),'confirmButtonColor':_0x165c('0x2a'),'width':_0x165c('0x2b')});_0x5e69c0[_0x165c('0x21')](_0x165c('0x74'));}});};_0xfb4fbb[_0x165c('0x75')]=function(){_0x5e69c0[_0x165c('0x21')](_0x165c('0x74'));$(_0x165c('0x76'))[_0x165c('0x7')]();};}]);

ManualApp.controller('MatrizController',
    ['$scope', '$rootScope', '$location', 'MatrizService', 'ArbolProblemaService','$routeParams', '$sce',
        function ($scope, $rootScope, $location, MatrizService, ArbolProblemaService, $routeParams, $sce) {

            $("#Panel2").hide();
            $("#problematicaCampo").removeAttr("disabled");
            $("#ProblematicaTexto").hide();
            $("#TituloProblema").hide();

            //Objeto con los problemas
            $scope.Problemas = [
                  {
                      Problema: "",
                      EjeX: "",
                      EjeY: "",
                      Criterio: ""
                  }
            ];

            $scope.DatosProyecto = {
                IdProyecto: $rootScope.proyecto.datos.id,
                IdMatriz: "",
                ProblemaGeneral:"",
                DetalleMat: [
                  {
                      Problema: "",
                      EjeX: "",
                      EjeY: "",
                      Criterio: ""
                  }
                ]
            }

            $scope.SeriesPuntos = [];

            //Funciòn para pausar el audio cuando se abra el video
            $scope.PauseAudio = function () {
                setTimeout(function () {
                    var audio = document.getElementById("audio-player");
                    audio.pause();
                }, 1000);
            }


            if ($rootScope.proyecto != undefined) {
                MatrizService.ConsultarMatriz($rootScope.proyecto.datos.id, function (response) {
                    if (response.success) {
                        $scope.DatosMatriz = response.matriz.DetalleMat;
                        $scope.DatosProyecto.ProblemaGeneral = response.matriz.ProblemaGeneral;
                      
                        $("#problemasMatriz").hide();
                        $("#Panel2").show();
                        //$("#problematicaCampo").attr("disabled", "disabled");
                        //$("#problematicaCampo").css("width", "115%");
                        $("#problematicaCampo").hide();
                  
                        $("#TituloProblema").show();
                        $("#BtnGuardar").hide();
                    } else {

                        $("#ModalOmitir").modal({ backdrop: 'static', keyboard: false });
                        $("#ModalOmitir").modal("show");

                    }
                })
            }
               
            $scope.OmitirMatriz = function ()
            {
                MatrizService.OmitirMatriz($rootScope.proyecto.datos.id, function (response) {
                    if (response.success) {
                        $location.url("/Menu")
                        $(".modal-backdrop").remove();
                    } 
                })
            }

            $scope.AgregarCampos = function () {

                if ($scope.Problemas.length < 25) {
                    $scope.Problemas.push({
                        Problema: "",

                    });
                } else {
                    alert("La cantidad de problemas a ingresar debe ser menor de 20");
                    return false;
                }

            };

            //Función para agregar la cantidad de problemas
            $scope.Agregar = function (Cantidad) {
                console.log(Cantidad);
                if ($scope.DatosProyecto.ProblemaGeneral == "") {

                    swal({
                        text: 'Ingrese el problema general',
                        confirmButtonColor: '#238276',
                        width: '25%'
                    })
                    return;
                }

                if (Cantidad == undefined) {

                    swal({
                        text: 'Elija la cantidad de problemas a evaluar',
                        confirmButtonColor: '#238276',
                        width: '25%'
                    })
                    return;
                }
                $scope.Problemas = [
                 {
                     Problema: "",
                     EjeX: "",
                     EjeY: "",
                     Criterio: ""
                 }
                ];
              

                var cantidad = parseInt(Cantidad);
                for (var i = 0; i < cantidad; i++) {
                    $scope.Problemas.push({
                        Problema: "",

                    });
                }
            }

            $scope.EliminarCampos = function (index) {

                if ($scope.Problemas.length > 1) {
                    $scope.Problemas.splice(index, 1);
                }

            };

            //Función para empezar a comparar los problemas
            $scope.mostrar = function () {               
                $scope.ProblemasCalificar = [];

                //-------------DESCOMENTARIAR -------------------------
                if ($scope.Problemas.length < 5) {
                    alertify.success("La cantidad mínima de problemas es 5")
                    return;
                } else {

                    var contador = 0;
                    $.each($scope.Problemas, function (index, value1) {

                        if (value1.Problema == "") {
                            contador++;
                        }
                    });
                    if (contador != 0) {
                        alertify.success("Debe llenar todos los campos")
                        return;
                    }
                }

                $scope.totalProblemas = [];

                $.each($scope.Problemas, function (index, value1) {
                    if (index != 0) {
                        $scope.ProblemasCalificar.push({
                            Problema: value1.Problema
                        })
                    }
                    var problema = value1.Problema
                    $scope.totalProblemas.push({
                        problema
                    })
                });

                //Funcion para evitar que se duplique un problema antes de comparar
                var totalProblemas = [];
                $.each($scope.Problemas, function (i, item) {
                    if ($.inArray(item.Problema, totalProblemas) === -1) {
                        totalProblemas.push(item.Problema);
                    }
                });
               
              

                if (totalProblemas.length > 0 && totalProblemas.length < $scope.Problemas.length) {


                    swal({
                        text: 'Ups! Tienes problemas repetidos',
                        confirmButtonColor: '#238276',
                        width: '25%'

                    })
                
                    return false;
                }

                $scope.ProblemaComparante = $scope.Problemas[0].Problema;

                setTimeout(function () {
                    $("#comparar li:nth-child(1)").show();
                }, 100);
                $("#Problematicas").hide();
                $("#mostrar").hide();
                $("#agregarProblemas").hide();
                    $("#problemasMatriz").hide();
                    $("#influeniciaTitulo").css({ "display": "block" });
                    $("#problematicaCampo").removeAttr("disabled");

            }

            //Inicialización de variables para la matriz 
            var contador = 0;
            $scope.sumaEjeX = 0;
            $scope.Datos = [];
            $scope.sumaEjeY = [];
            $scope.Puntos = [];
            var suma = 0;

            //funcion para evaluar los problemas
            $scope.Calificar = function (index, valor, problematica) {

                suma = parseInt(suma) + parseInt(valor);


                $scope.sumaEjeY.push(parseInt(valor));

                //$scope.ProblemasCalificar.push($scope.ProblemasCalificar[index],valor);
                $scope.ProblemasCalificar.splice(index, 1);

                setTimeout(function () {
                    $("#comparar li:nth-child(" + (index + 1) + ")").show();
                }, 100);

                if ($scope.ProblemasCalificar.length == 0) {

                    $("#ModalConfirmar").modal({ backdrop: 'static', keyboard: false });
                    $("#ModalConfirmar").modal("show")

                }

            }

            //Funcion para comfirmar si desea repetir las calificaciones de la iteración.
            $scope.ConfirmarCalificacion = function (valor) {

                if (valor == 1) {

                    $scope.sumaEjeX = suma;

                } else {
                    $.each($scope.Problemas, function (index, value1) {
                        if (index != contador) {

                            $scope.ProblemasCalificar.push({
                                Problema: value1.Problema,

                            });

                        }
                    });
                    setTimeout(function () {
                        $("#comparar li:nth-child(1)").show();
                    }, 100);

                    return false;
                }

                suma = 0;
                $scope.sumaEjeY.splice(contador, 0, 0);
                $scope.Datos.push($scope.sumaEjeY);
             
                $scope.sumaEjeY = [];

                $scope.Problemas[contador].EjeX = $scope.sumaEjeX;
                $scope.sumaEjeX = 0;
                contador++;

                var prueba = contador + 1;
                if (prueba > $scope.Problemas.length) {
                    //alert("termino");
                 
                    //Fununción para sumar el eje Y del array con las calificaciones de cada problema
                    var sumY = (r, a) => r.map((b, i) => a[i] + b);

                    var sumaX = function (a, b) { return a + b; }

                    var calificacionesY = $scope.Datos.reduce(sumY);
                    $.each(calificacionesY, function (index1, value) {
                        $scope.Problemas[index1].EjeY = value;
                    });


                    //Objeto para que la grafica inicie desde el punto 0 de la grafica
                    var inicio = {
                        name: "Problemas",
                        color: 'rgba(0,0,0,0.0)',
                        data: [[0, 0]]
                    }
                   
                    $scope.SeriesPuntos.push(inicio);

                    $.each($scope.Problemas, function (index, value) {
                        var dato = {
                            name: value.Problema,
                            color: 'rgba(0,0,255,0.6)',
                            data: [[value.EjeX, value.EjeY]]
                        };
                        $scope.SeriesPuntos.push(dato);
                    });

                    $scope.EvaluacionCriterios();
                    $scope.grafica();
                   
                    console.log($scope.Problemas);

                    contador = 0;
                    return false;
                }


                $scope.ProblemaComparante = $scope.Problemas[contador].Problema;


                $.each($scope.Problemas, function (index, value1) {
                    if (index != contador) {

                        $scope.ProblemasCalificar.push({
                            Problema: value1.Problema,

                        });

                    }
                });
                setTimeout(function () {
                    $("#comparar li:nth-child(1)").show();
                }, 100);
            }

            //Función para pintar la grafica con los problemas calificados
            $scope.grafica = function () {

                $("#personaje").hide();
                $("#grafica").show();
                $("#problema").hide();
                $("#influeniciaTitulo").hide();


                Highcharts.chart('container', {
                    chart: {
                        type: 'scatter',
                        height: 480
                        //zoomType: 'xy'
                    },
                    title: {
                        text: 'GRAFICA VESTER'
                    },
                    //subtitle: {
                    //    text: 'Source: Heinz  2003'
                    //},
                    xAxis: {
                        title: {
                            enabled: true,
                            text: 'EJE X'
                        },
                        startOnTick: false,
                        endOnTick: false,
                        showLastLabel: true,
                        allowDecimals: false
                    },
                    yAxis: {
                        title: {
                            text: 'EJE Y'
                        },

                        startOnTick: false,
                        endOnTick: true,
                        showLastLabel: true,
                        allowDecimals: false,
                    },
                    legend: {
                        enabled: false
                    },
                    plotOptions: {
                        scatter: {
                            marker: {
                                radius: 5,
                                states: {
                                    hover: {
                                        enabled: true,
                                        lineColor: 'rgb(100,100,100)'
                                    }
                                }
                            },
                            states: {
                                hover: {
                                    marker: {
                                        enabled: false
                                    }
                                }
                            },
                            tooltip: {
                                headerFormat: '<b>{series.name}</b><br>',
                                pointFormat: '{point.x} X, {point.y} Y'
                            }
                        }
                    },
                    series: $scope.SeriesPuntos
                });

                console.log($scope.SeriesPuntos);
                var tamañoMaxX = (($(".highcharts-root").width()) / 2) + 27;
                var tamañoMaxY = $(".highcharts-root").height();
                var animacion = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                                window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;;

                //Función para repetir el calcula de la linea vertical 
                function repetir() {
                    $(".highcharts-yaxis-grid path:first-child").attr("d", "M " + tamañoMaxX + " 52 L " + tamañoMaxX + " " + (tamañoMaxY - 60) + "").attr("stroke", "blue").attr("stroke-width", "2");
                    animacion(repetir);
                }

                animacion(repetir);

                $("#container").prepend('<span id="lineaTerror"></span>');

                $("#lineaTerror").css({
                    "width": $(".highcharts-root").width() - 71 + "px",
                    "height": "2px",
                    "top": (((tamañoMaxY / 2) - 8) + "px"),
                    "left": "110px",
                    "background": "blue",
                    "z-index": "1",
                    "position": "absolute"
                    //"margin-left": "17%"
                });

                $(".highcharts-button , .highcharts-credits").hide();


            }

            //Función para evaluar los criterios de cada problema
            $scope.EvaluacionCriterios = function () {

                var totalCalificacion = (parseInt($scope.Problemas.length) * 3) - 3;
                //var puntoMedioX = (totalCalificacion / 2);
                var puntoMedioX = 0;
                var puntoAltoY = 0;
                var puntoAltoX = 0;
                var puntoMedioY = 0;

                $.each($scope.Problemas, function (index, value) {

                    if (value.EjeY >= puntoAltoY) {

                        puntoAltoY = value.EjeY;
                        puntoMedioY = (parseInt(puntoAltoY) + 1) / 2;
                    }
                    if (value.EjeX >= puntoAltoX) {

                        puntoAltoX = value.EjeX;
                        puntoMedioX = (parseInt(puntoAltoX) / 2);
                    }
                });

                console.log(puntoMedioY);
                console.log(puntoMedioX);

                $scope.PuntosCriticos = [];

                $.each($scope.Problemas, function (index, value) {

                    if (value.EjeX <= puntoMedioX && value.EjeY >= puntoMedioY) {

                        $scope.Problemas[index].Criterio = "Pasivos";

                    } else if (value.EjeX > puntoMedioX && value.EjeY > puntoMedioY) {

                        $scope.Problemas[index].Criterio = "Criticos";

                        $scope.PuntosCriticos.push($scope.Problemas[index]);


                    } else if (value.EjeX < puntoMedioX && value.EjeY < puntoMedioY) {

                        $scope.Problemas[index].Criterio = "Indiferentes";

                    } else if (value.EjeX >= puntoMedioX && value.EjeY <= puntoMedioY) {

                        $scope.Problemas[index].Criterio = "Activos";

                    }
                });

                var contador = 0;
                var valorPuntoCritico = 0

                if ($scope.PuntosCriticos.length > 0 ) {
                    $.each($scope.PuntosCriticos, function (index, value) {
                        var valor = parseInt(value.EjeX) + parseInt(value.EjeY);
                        valorPuntoCritico = Math.sqrt(valor);

                        if (valorPuntoCritico > contador) {

                            contador = valorPuntoCritico;
                            $scope.puntoAlto = (index);
                        }
                    });

                    $.each($scope.SeriesPuntos, function (index, value) {

                        if (value.name == $scope.PuntosCriticos[$scope.puntoAlto].Problema) {
                            var inicio = {
                                name: "Punto Critico: " + $scope.PuntosCriticos[$scope.puntoAlto].Problema,
                                color: 'rgba(255,0,0,1)',
                                data: [[$scope.PuntosCriticos[$scope.puntoAlto].EjeX, $scope.PuntosCriticos[$scope.puntoAlto].EjeY]]
                            }
                            $scope.SeriesPuntos[index] = inicio;
                        }
                    })

                    $.each($scope.Problemas, function (index, value) {

                        if (value.Problema == $scope.PuntosCriticos[$scope.puntoAlto].Problema) {

                            $scope.Problemas[index].Criterio = "Punto Critico";
                        } if (value.Criterio == "Criticos" && value.Problema != $scope.PuntosCriticos[$scope.puntoAlto].Problema) {
                            $scope.Problemas[index].Criterio = "Activos";
                        }
                    });

                } else {
                    var contador = 0;
                    $.each($scope.SeriesPuntos, function (index, value) {
                        if (contador == 0) {
                            var inicio = {
                                name: "Punto Critico: " + $scope.Problemas[0].Problema,
                                color: 'rgba(255,0,0,1)',
                                data: [[$scope.Problemas[0].EjeX, $scope.Problemas[0].EjeY]]
                            }
                            $scope.SeriesPuntos[index] = inicio;
                            contador++;
                        }

                    });
                }
               


            
                //$scope.grafica();
                //console.log($scope.Problemas);

            }

            //Función para habilitar el botón de califcar 
            $scope.HabilitarEnviar = function () {

                $("#Calificar").attr("disabled", false);
            }

            //Función para almacenar los datos de la matriz  
            $scope.Guardar = function () {
                $scope.DatosProyecto.DetalleMat = $scope.Problemas;
                if ($scope.DatosProyecto.DetalleMat[0].Criterio == "") {
                    swal({
                        text: 'Debe realizar la matriz de Vester',
                        confirmButtonColor: '#238276',
                        width: '25%'

                    })
                  
                    return;
                }
                waitingDialog.show();
           
                MatrizService.Guardar($scope.DatosProyecto, function (response) {
                    if (response.success) {
                        waitingDialog.hide();
                        swal({
                            text: 'Registro Exitoso',
                            confirmButtonColor: '#238276',
                            width: '25%'

                        })
                      
                        $location.url("/Menu");
                        
                   
                    }
                })
            }

            $scope.Regresar = function () {

                $location.url("/Menu");
                $(".notify").hide();

            }



        }]);