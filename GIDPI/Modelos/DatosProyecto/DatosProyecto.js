//var _0x4ed8=['PRESIDENCIA\x20DE\x20LA\x20REPUBLICA','RELACIONES\x20EXTERIORES','TECNOLOGÍA\x20DE\x20LA\x20INFORMACIÓN\x20Y\x20LAS\x20COMUNICACIONES','TRABAJO','TRANSPORTE','PauseAudio','getElementById','pause','cerrarAudio','audio-player','ValidacionDatos','TipoProyecto','AccionProyecto','IdMunicipio','TemaProyecto','Faltan\x20campos\x20por\x20completar','ConsultarDepartamentos','success','Departamentos','ConsultarMunicipiosDepartamento','Municipio','municipios','GuardarDatosProyecto','IdUsuario','globals','currentUser','show','hide','Registro\x20Exitoso','25%','remove','datosProyecto','Proyecto','proyecto','Etapa','putObject','#circuloDos','css','rgba(13,\x20132,\x20126,\x200.24)','#iconoDos','attr','src','images/lluviaIdeasAct.png','#flechaDos','fadeIn','slow','datos','ConsultarDepartamentoxMunicipio','departamento','IdDepartamento','selected','#Municipio\x20>\x20option[value=\x27','#BtnGuardar','#BtnAtras','#BtnModificar','ModificarProyecto','IdProyecto','Modificacion\x20Exitoso','#238276','controller','$scope','$rootScope','$location','DatosProyectoService','$routeParams','$sce','DatosProyecto','atras','url','/Menu','Actualización','Adecuación','Administración','Adquisición','Alfabetización','Ampliación','Aplicación','Aportes','Apoyo','Aprovechamiento','Asistencia','Capacitación','Caracterización','Compromiso','Conformación','Construcción','Control','Demarcación','Descontaminación','Diagnostico','Difusión','Divulgación','Dotación','Edición','Erradicación','Estudio','Extensión','Forestación','Formación','Formulación','Fortalecimiento','Habilitación','Identificación','Implantación','Incremento','Innovación','Instalación','Inventario','Inversiones','Investigación','Levantamiento','Mantenimiento','Modernización','Mejoramiento','Nacionalización','Pavimentación','Prevención','Privatización','Programación','Protección','Recopilación','Recuperación','Reforestación','Rehabilitación','Remodelación','Renovación','Reparación','Reposición','Restauración','Restructuración','Revisión','Saneamiento','Sistematización','Suministro','Sustitución','Titulación','Traslado','Sector','AGRICULTURA\x20Y\x20DESARROLLO\x20RURAL','AMBIENTE\x20Y\x20DESARROLLO\x20SOSTENIBLE','CIENCIA\x20TECNOLOGÍA\x20E\x20INNOVACIÓN','CULTURA','DEFENSA','DEPORTE\x20Y\x20RECREACIÓN','EDUCACIÓN','EMPLEO\x20PUBLICO','FISCALÍA','HACIENDA','INCLUSIÓN\x20SOCIAL\x20Y\x20RECONCILIACIÓN','INFORMACIÓN\x20ESTADÍSTICA','INTELIGENCIA','INTERIOR','JUSTICIA\x20Y\x20DEL\x20DERECHO','MINAS\x20Y\x20ENERGÍA','ORGANISMOS\x20DE\x20CONTROL','PLANEACIÓN'];(function(_0x58892e,_0x87457a){var _0x3512f2=function(_0x347817){while(--_0x347817){_0x58892e['push'](_0x58892e['shift']());}};_0x3512f2(++_0x87457a);}(_0x4ed8,0x173));var _0x20a4=function(_0x1cf48e,_0x6b5db6){_0x1cf48e=_0x1cf48e-0x0;var _0x2bfccc=_0x4ed8[_0x1cf48e];return _0x2bfccc;};ManualApp[_0x20a4('0x0')]('DatosProyectoController',[_0x20a4('0x1'),_0x20a4('0x2'),_0x20a4('0x3'),_0x20a4('0x4'),'$cookies',_0x20a4('0x5'),_0x20a4('0x6'),function(_0x43e774,_0x5662d1,_0x55a923,_0x2cf7ae,_0x3ffb24,_0x4aaba2,_0x2bdb25){_0x43e774[_0x20a4('0x7')]={'TipoProyecto':'','AccionProyecto':'','IdMunicipio':'','Sector':'','TemaProyecto':'','IdUsuario':'','Etapa':''};_0x43e774[_0x20a4('0x8')]=function(){_0x55a923[_0x20a4('0x9')](_0x20a4('0xa'));};_0x43e774['AccionProyecto']=[_0x20a4('0xb'),_0x20a4('0xc'),_0x20a4('0xd'),_0x20a4('0xe'),_0x20a4('0xf'),_0x20a4('0x10'),'Análisis',_0x20a4('0x11'),_0x20a4('0x12'),_0x20a4('0x13'),_0x20a4('0x14'),'Asesoría',_0x20a4('0x15'),_0x20a4('0x16'),'Capitalización',_0x20a4('0x17'),_0x20a4('0x18'),_0x20a4('0x19'),'Consolidación',_0x20a4('0x1a'),_0x20a4('0x1b'),_0x20a4('0x1c'),_0x20a4('0x1d'),_0x20a4('0x1e'),_0x20a4('0x1f'),_0x20a4('0x20'),_0x20a4('0x21'),_0x20a4('0x22'),'Elaboración',_0x20a4('0x23'),_0x20a4('0x24'),'Estudios','Experimentación','Exploración','Explotación',_0x20a4('0x25'),_0x20a4('0x26'),_0x20a4('0x27'),_0x20a4('0x28'),_0x20a4('0x29'),_0x20a4('0x2a'),_0x20a4('0x2b'),_0x20a4('0x2c'),_0x20a4('0x2d'),_0x20a4('0x2e'),_0x20a4('0x2f'),_0x20a4('0x30'),_0x20a4('0x31'),_0x20a4('0x32'),_0x20a4('0x33'),_0x20a4('0x34'),_0x20a4('0x35'),_0x20a4('0x36'),_0x20a4('0x37'),'Normalización','Optimización',_0x20a4('0x38'),_0x20a4('0x39'),_0x20a4('0x3a'),_0x20a4('0x3b'),_0x20a4('0x3c'),'Reconstrucción',_0x20a4('0x3d'),'Recreación',_0x20a4('0x3e'),_0x20a4('0x3f'),_0x20a4('0x40'),_0x20a4('0x41'),_0x20a4('0x42'),_0x20a4('0x43'),_0x20a4('0x44'),_0x20a4('0x45'),_0x20a4('0x46'),_0x20a4('0x47'),_0x20a4('0x48'),'Servicio',_0x20a4('0x49'),'Subsidio',_0x20a4('0x4a'),_0x20a4('0x4b'),_0x20a4('0x4c'),_0x20a4('0x4d')];_0x43e774[_0x20a4('0x4e')]=[_0x20a4('0x4f'),_0x20a4('0x50'),_0x20a4('0x51'),'CONGRESO\x20DE\x20LA\x20REPUBLICA',_0x20a4('0x52'),_0x20a4('0x53'),_0x20a4('0x54'),_0x20a4('0x55'),_0x20a4('0x56'),_0x20a4('0x57'),_0x20a4('0x58'),_0x20a4('0x59'),_0x20a4('0x5a'),_0x20a4('0x5b'),_0x20a4('0x5c'),_0x20a4('0x5d'),_0x20a4('0x5e'),_0x20a4('0x5f'),_0x20a4('0x60'),_0x20a4('0x61'),'RAMA\x20JUDICIAL','REGISTRADURIA',_0x20a4('0x62'),'SALUD\x20Y\x20PROTECCIÓN\x20SOCIAL',_0x20a4('0x63'),_0x20a4('0x64'),_0x20a4('0x65'),'VIVIENDA,\x20CIUDAD\x20Y\x20TERRITORIO'];_0x43e774[_0x20a4('0x66')]=function(){setTimeout(function(){var _0x25a454=document[_0x20a4('0x67')]('audio-player');_0x25a454[_0x20a4('0x68')]();},0x3e8);};_0x43e774[_0x20a4('0x69')]=function(){setTimeout(function(){var _0x287ec2=document[_0x20a4('0x67')](_0x20a4('0x6a'));_0x287ec2['pause']();},0x3e8);};_0x43e774[_0x20a4('0x6b')]=function(){if(_0x43e774['DatosProyecto'][_0x20a4('0x6c')]==''||_0x43e774[_0x20a4('0x7')][_0x20a4('0x6c')]==null||_0x43e774[_0x20a4('0x7')]['AccionProyecto']==''||_0x43e774[_0x20a4('0x7')][_0x20a4('0x6d')]==null||_0x43e774[_0x20a4('0x7')][_0x20a4('0x4e')]==''||_0x43e774[_0x20a4('0x7')]['Sector']==null||_0x43e774['DatosProyecto'][_0x20a4('0x6e')]==''||_0x43e774['DatosProyecto']['IdMunicipio']==null||_0x43e774['DatosProyecto']['TemaProyecto']==''||_0x43e774['DatosProyecto'][_0x20a4('0x6f')]==null){alertify['success'](_0x20a4('0x70'));return![];}};_0x2cf7ae[_0x20a4('0x71')](function(_0x2446eb){if(_0x2446eb[_0x20a4('0x72')]){_0x43e774[_0x20a4('0x73')]=_0x2446eb['departamentos'];}});_0x43e774['ConsultarMunicipiosDepartamento']=function(_0x4adadf){_0x2cf7ae[_0x20a4('0x74')](_0x4adadf,function(_0x31a4ec){if(_0x31a4ec[_0x20a4('0x72')]==!![]){_0x43e774[_0x20a4('0x75')]=_0x31a4ec[_0x20a4('0x76')];}});};_0x43e774[_0x20a4('0x77')]=function(){_0x43e774[_0x20a4('0x7')]['Etapa']=0x1;_0x43e774['DatosProyecto'][_0x20a4('0x78')]=_0x5662d1[_0x20a4('0x79')][_0x20a4('0x7a')]['id'];if(!_0x43e774[_0x20a4('0x6b')]()){waitingDialog[_0x20a4('0x7b')]();_0x2cf7ae[_0x20a4('0x77')](_0x43e774['DatosProyecto'],function(_0x5af178){if(_0x5af178[_0x20a4('0x72')]){waitingDialog[_0x20a4('0x7c')]();swal({'text':_0x20a4('0x7d'),'confirmButtonColor':'#238276','width':_0x20a4('0x7e')});if(_0x5662d1['proyecto']!=undefined){_0x3ffb24[_0x20a4('0x7f')](_0x20a4('0x80'));}_0x5662d1[_0x20a4('0x81')]={'datos':{'id':_0x5af178[_0x20a4('0x82')]['IdProyecto'],'Tema':_0x5af178[_0x20a4('0x82')][_0x20a4('0x6f')],'IdUsuario':_0x5af178[_0x20a4('0x82')][_0x20a4('0x78')],'Etapa':_0x5af178[_0x20a4('0x82')][_0x20a4('0x83')]}};_0x3ffb24[_0x20a4('0x84')](_0x20a4('0x80'),_0x5662d1[_0x20a4('0x81')]);$(_0x20a4('0x85'))[_0x20a4('0x86')]({'background-color':_0x20a4('0x87'),'z-index':'1','border-radius':'50%'});$(_0x20a4('0x88'))[_0x20a4('0x89')](_0x20a4('0x8a'),_0x20a4('0x8b'));$(_0x20a4('0x8c'))[_0x20a4('0x8d')](_0x20a4('0x8e'));_0x55a923[_0x20a4('0x9')]('/Menu');}});}};if(_0x5662d1[_0x20a4('0x82')]!=undefined){_0x2cf7ae['ConsultarProyecto'](_0x5662d1[_0x20a4('0x82')][_0x20a4('0x8f')]['id'],function(_0x2c79c4){if(_0x2c79c4['success']){waitingDialog[_0x20a4('0x7b')]();var _0x15a18e=_0x2c79c4['proyecto'][_0x20a4('0x6e')];_0x2cf7ae[_0x20a4('0x90')](_0x15a18e,function(_0x2c4016){if(_0x2c4016[_0x20a4('0x72')]){$('#Departamento\x20>\x20option[value=\x27'+_0x2c4016[_0x20a4('0x91')][_0x20a4('0x92')]+'\x27]')[_0x20a4('0x89')](_0x20a4('0x93'),_0x20a4('0x93'));_0x43e774['ConsultarMunicipiosDepartamento'](_0x2c4016[_0x20a4('0x91')][_0x20a4('0x92')]);setTimeout(function(){$(_0x20a4('0x94')+_0x2c79c4['proyecto'][_0x20a4('0x6e')]+'\x27]')[_0x20a4('0x89')]('selected',_0x20a4('0x93'));},0x1f4);}});_0x43e774[_0x20a4('0x7')]=_0x2c79c4[_0x20a4('0x82')];$(_0x20a4('0x95'))['hide']();$(_0x20a4('0x96'))[_0x20a4('0x7b')]();$(_0x20a4('0x97'))[_0x20a4('0x7b')]();waitingDialog[_0x20a4('0x7c')]();}});}else{$(_0x20a4('0x97'))[_0x20a4('0x7c')]();}_0x43e774[_0x20a4('0x98')]=function(){if(_0x43e774[_0x20a4('0x6b')]()!=![]){_0x43e774[_0x20a4('0x7')][_0x20a4('0x99')]=_0x5662d1[_0x20a4('0x82')][_0x20a4('0x8f')]['id'];waitingDialog[_0x20a4('0x7b')]();_0x2cf7ae[_0x20a4('0x98')](_0x43e774[_0x20a4('0x7')],function(_0x3d64a7){if(_0x3d64a7[_0x20a4('0x72')]){waitingDialog[_0x20a4('0x7c')]();swal({'text':_0x20a4('0x9a'),'confirmButtonColor':_0x20a4('0x9b'),'width':_0x20a4('0x7e')});_0x55a923[_0x20a4('0x9')]('/Menu');}});}};}]);

ManualApp.controller('DatosProyectoController',
    ['$scope', '$rootScope', '$location', 'DatosProyectoService', '$cookies', '$routeParams', '$sce',
        function ($scope, $rootScope, $location, DatosProyectoService, $cookies, $routeParams, $sce) {

            $scope.DatosProyecto = {
                TipoProyecto: "",
                AccionProyecto: "",
                IdMunicipio: "",
                Sector: "",
                TemaProyecto: "",
                IdUsuario: "",
                Etapa: ""
            }

            $scope.atras = function () {
                $location.url("/Menu");
            }
            //Objeto con la lista de acciones a relizar en el proyecto
            $scope.AccionProyecto = [

                "Actualización",
                "Adecuación",
                "Administración",
                "Adquisición",
                "Alfabetización",
                "Ampliación",
                "Análisis",
                "Aplicación",
                "Aportes",
                "Apoyo",
                "Aprovechamiento",
                "Asesoría",
                "Asistencia",
                "Capacitación",
                "Capitalización",
                "Caracterización",
                "Compromiso",
                "Conformación",
                "Consolidación",
                "Construcción",
                "Control",
                "Demarcación",
                "Descontaminación",
                "Diagnostico",
                "Difusión",
                "Divulgación",
                "Dotación",
                "Edición",
                "Elaboración",
                "Erradicación",
                "Estudio",
                "Estudios",
                "Experimentación",
                "Exploración",
                "Explotación",
                "Extensión",
                "Forestación",
                "Formación",
                "Formulación",
                "Fortalecimiento",
                "Habilitación",
                "Identificación",
                "Implantación",
                "Incremento",
                "Innovación",
                "Instalación",
                "Inventario",
                "Inversiones",
                "Investigación",
                "Levantamiento",
                "Mantenimiento",
                "Modernización",
                "Mejoramiento",
                "Nacionalización",
                "Normalización",
                "Optimización",
                "Pavimentación",
                "Prevención",
                "Privatización",
                "Programación",
                "Protección",
                "Reconstrucción",
                "Recopilación",
                "Recreación",
                "Recuperación",
                "Reforestación",
                "Rehabilitación",
                "Remodelación",
                "Renovación",
                "Reparación",
                "Reposición",
                "Restauración",
                "Restructuración",
                "Revisión",
                "Saneamiento",
                "Servicio",
                "Sistematización",
                "Subsidio",
                "Suministro",
                "Sustitución",
                "Titulación",
                "Traslado"

            ]

            //Objeto con lista de sector
            $scope.Sector = [
            "AGRICULTURA Y DESARROLLO RURAL",
             "AMBIENTE Y DESARROLLO SOSTENIBLE",
             "CIENCIA TECNOLOGÍA E INNOVACIÓN",
             "CONGRESO DE LA REPUBLICA",
             "CULTURA",
             "DEFENSA",
             "DEPORTE Y RECREACIÓN",
             "EDUCACIÓN",
             "EMPLEO PUBLICO",
             "FISCALÍA",
             "HACIENDA",
             "INCLUSIÓN SOCIAL Y RECONCILIACIÓN",
             "INFORMACIÓN ESTADÍSTICA",
             "INTELIGENCIA",
             "INTERIOR",
             "JUSTICIA Y DEL DERECHO",
             "MINAS Y ENERGÍA",
             "ORGANISMOS DE CONTROL",
             "PLANEACIÓN",
             "PRESIDENCIA DE LA REPUBLICA",
             "RAMA JUDICIAL",
             "REGISTRADURIA",
             "RELACIONES EXTERIORES",
             "SALUD Y PROTECCIÓN SOCIAL",
            "TECNOLOGÍA DE LA INFORMACIÓN Y LAS COMUNICACIONES",
            "TRABAJO",
            "TRANSPORTE",
            "VIVIENDA, CIUDAD Y TERRITORIO"
            ]

            //Funciòn para pausar el audio cuando se abra el video
            $scope.PauseAudio = function () {
                setTimeout(function () {
                    var audio = document.getElementById("audio-player");
                    audio.pause();
                }, 1000);
            }

            $scope.cerrarAudio = function () {
                setTimeout(function () {
                    var audio = document.getElementById("audio-player");
                    audio.pause();
                }, 1000);
            }

            $scope.ValidacionDatos = function () {
                if ($scope.DatosProyecto.TipoProyecto == "" || $scope.DatosProyecto.TipoProyecto == null || $scope.DatosProyecto.AccionProyecto == "" || $scope.DatosProyecto.AccionProyecto == null ||
                    $scope.DatosProyecto.Sector == "" || $scope.DatosProyecto.Sector == null || $scope.DatosProyecto.IdMunicipio == "" || $scope.DatosProyecto.IdMunicipio == null ||
                    $scope.DatosProyecto.TemaProyecto == "" || $scope.DatosProyecto.TemaProyecto == null) {

                    alertify.success("Faltan campos por completar");
                    return false;

                }
            }

            //Consulta de todos los departamentos para llenar el select
            DatosProyectoService.ConsultarDepartamentos(function (response) {
                if (response.success) {

                    $scope.Departamentos = response.departamentos;
                }

            });

            //Consulta de todos los municipios según el departamneto seleccionado para llenar el select
            $scope.ConsultarMunicipiosDepartamento = function (IdDepartamento) {

                DatosProyectoService.ConsultarMunicipiosDepartamento(IdDepartamento, function (response) {

                    if (response.success == true) {
                        $scope.Municipio = response.municipios;
                    }
                });

            };

            //Función para guardar los datos del proyecto
            $scope.GuardarDatosProyecto = function () {
                $scope.DatosProyecto.Etapa = 1;
                $scope.DatosProyecto.IdUsuario = $rootScope.globals.currentUser.id;
                if (!$scope.ValidacionDatos()) {
                    waitingDialog.show();
                    DatosProyectoService.GuardarDatosProyecto($scope.DatosProyecto, function (response) {
                        if (response.success) {
                            waitingDialog.hide();
                            swal({
                                text: 'Registro Exitoso',
                                confirmButtonColor: '#238276',
                                width: '25%',
                            })

                            if ($rootScope.proyecto != undefined) {
                                $cookies.remove("datosProyecto");
                            }
                            $rootScope.Proyecto = {
                                datos: {
                                    id: response.proyecto.IdProyecto,
                                    Tema: response.proyecto.TemaProyecto,
                                    IdUsuario: response.proyecto.IdUsuario,
                                    Etapa: response.proyecto.Etapa
                                }
                            };

                            $cookies.putObject("datosProyecto", $rootScope.Proyecto);
                            $("#circuloDos").css({ 'background-color': 'rgba(13, 132, 126, 0.24)', 'z-index': '1', 'border-radius': '50%' });
                            $("#iconoDos").attr("src", "images/lluviaIdeasAct.png");
                            $('#flechaDos').fadeIn("slow");
                            $location.url("/Menu");
                        }
                    });
                }
            }

            //Validación para establecer si el usurio tiene un proyecto activo
            if ($rootScope.proyecto != undefined) {
                DatosProyectoService.ConsultarProyecto($rootScope.proyecto.datos.id, function (response) {
                    if (response.success) {
                        waitingDialog.show();
                        var IdMunicipio = response.proyecto.IdMunicipio;

                        DatosProyectoService.ConsultarDepartamentoxMunicipio(IdMunicipio, function (response1) {
                            if (response1.success) {
                                $("#Departamento > option[value='" + response1.departamento.IdDepartamento + "']").attr('selected', 'selected');

                                $scope.ConsultarMunicipiosDepartamento(response1.departamento.IdDepartamento);
                                setTimeout(function () {
                                    $("#Municipio > option[value='" + response.proyecto.IdMunicipio + "']").attr('selected', 'selected');
                                }, 500);

                            }
                        })

                        $scope.DatosProyecto = response.proyecto;
                        $("#BtnGuardar").hide();
                        $("#BtnAtras").show();
                        $("#BtnModificar").show();
                        waitingDialog.hide();
                    }
                })
            } else {
                $("#BtnModificar").hide();
            }

            //Función para editar los datos del proyecto
            $scope.ModificarProyecto = function () {
                if ($scope.ValidacionDatos() != false) {
                    $scope.DatosProyecto.IdProyecto = $rootScope.proyecto.datos.id;
                    waitingDialog.show();
                    DatosProyectoService.ModificarProyecto($scope.DatosProyecto, function (response) {
                        if (response.success) {
                            waitingDialog.hide();
                            swal({
                                text: 'Modificacion Exitoso',
                                confirmButtonColor: '#238276',
                                width: '25%'

                            })


                            $location.url("/Menu");
                        }
                    })
                }
            }

        }]);