//ofuscado
//var _0xa9e0 = ['setOnLoadCallback', 'visualization', 'arrayToDataTable', 'Task', 'Hours\x20per\x20Day', 'INNOVACIÓN', 'SERVICIOS\x20TECNOLÓGICOS', 'INVESTIGACIÓN', 'OTRO', 'none', '#088A08', '#238276', '#04B45F', '#DF7401', 'PieChart', 'getElementById', 'donutchart', 'draw', 'FINALIZADOS', 'EN\x20DESARROLLO', 'label', 'donutchart2', 'Total\x20matrices\x20de\x20vester', 'Proyectos\x20sin\x20matriz\x20de\x20vester', 'Matriz', 'AdminController', '$rootScope', '$location', 'AdminService', '$cookies', '$routeParams', 'success', 'Usuarios', 'Datos', 'PersonaNatural', 'personaJuridica', 'charts', 'load', 'current', 'corechart']; (function (_0x5b3c11, _0xa3d5e9) { var _0x443fcf = function (_0x29016f) { while (--_0x29016f) { _0x5b3c11['push'](_0x5b3c11['shift']()); } }; _0x443fcf(++_0xa3d5e9); }(_0xa9e0, 0x1a9)); var _0x0a9e = function (_0x53c3ed, _0x34ca88) { _0x53c3ed = _0x53c3ed - 0x0; var _0xf6c602 = _0xa9e0[_0x53c3ed]; return _0xf6c602; }; ManualApp['controller'](_0x0a9e('0x0'), ['$scope', _0x0a9e('0x1'), _0x0a9e('0x2'), _0x0a9e('0x3'), _0x0a9e('0x4'), _0x0a9e('0x5'), '$sce', function (_0x219af0, _0x441e3a, _0x2cc193, _0x5f41ea, _0x503809, _0xe42b77, _0x56465b) { _0x5f41ea['cosultarGrafica'](function (_0x39753a) { if (_0x39753a[_0x0a9e('0x6')] == !![]) { _0x219af0[_0x0a9e('0x7')] = _0x39753a[_0x0a9e('0x8')][0x0]; _0x219af0[_0x0a9e('0x9')] = _0x39753a[_0x0a9e('0x8')][0x1]; _0x219af0[_0x0a9e('0xa')] = _0x39753a['Datos'][0x2]; _0x219af0['Proyectos'] = _0x39753a['Datos'][0x3]; google[_0x0a9e('0xb')][_0x0a9e('0xc')](_0x0a9e('0xd'), { 'packages': [_0x0a9e('0xe')] }); google[_0x0a9e('0xb')][_0x0a9e('0xf')](_0x5db4b0); function _0x5db4b0() { var _0x4283ce = google[_0x0a9e('0x10')][_0x0a9e('0x11')]([[_0x0a9e('0x12'), _0x0a9e('0x13')], [_0x0a9e('0x14'), _0x39753a['Datos'][0x4]], [_0x0a9e('0x15'), _0x39753a['Datos'][0x5]], [_0x0a9e('0x16'), _0x39753a['Datos'][0x6]], [_0x0a9e('0x17'), _0x39753a[_0x0a9e('0x8')][0x7]]]); var _0x48f32d = { 'pieHole': 0.4, 'backgroundColor': '', 'legend': _0x0a9e('0x18'), 'pieSliceText': 'label', 'is3D': !![], 'slices': { 0: { 'color': _0x0a9e('0x19') }, 1: { 'offset': 0.1, 'color': _0x0a9e('0x1a') }, 2: { 'offset': 0.2, 'color': _0x0a9e('0x1b') }, 3: { 'offset': 0.1, 'color': _0x0a9e('0x1c') } } }; var _0x31b1ca = new google[(_0x0a9e('0x10'))][(_0x0a9e('0x1d'))](document[_0x0a9e('0x1e')](_0x0a9e('0x1f'))); _0x31b1ca[_0x0a9e('0x20')](_0x4283ce, _0x48f32d); } google[_0x0a9e('0xb')][_0x0a9e('0xc')](_0x0a9e('0xd'), { 'packages': [_0x0a9e('0xe')] }); google[_0x0a9e('0xb')]['setOnLoadCallback'](_0x20f109); function _0x20f109() { var _0x5a09ef = google['visualization'][_0x0a9e('0x11')]([[_0x0a9e('0x12'), _0x0a9e('0x13')], [_0x0a9e('0x21'), _0x39753a[_0x0a9e('0x8')][0x8]], [_0x0a9e('0x22'), _0x39753a[_0x0a9e('0x8')][0x9]]]); var _0x3b45bc = { 'pieHole': 0.4, 'backgroundColor': '', 'legend': _0x0a9e('0x18'), 'pieSliceText': _0x0a9e('0x23'), 'is3D': !![], 'slices': { 0: { 'color': _0x0a9e('0x19') }, 1: { 'offset': 0.2, 'color': _0x0a9e('0x1a') } } }; var _0x5ea472 = new google['visualization'][(_0x0a9e('0x1d'))](document[_0x0a9e('0x1e')](_0x0a9e('0x24'))); _0x5ea472[_0x0a9e('0x20')](_0x5a09ef, _0x3b45bc); } var _0x526cf3 = _0x39753a[_0x0a9e('0x8')][0x3] - _0x39753a[_0x0a9e('0x8')][0xa]; google[_0x0a9e('0xb')]['load'](_0x0a9e('0xd'), { 'packages': [_0x0a9e('0xe')] }); google[_0x0a9e('0xb')][_0x0a9e('0xf')](_0x140511); function _0x140511() { var _0x1538a4 = google[_0x0a9e('0x10')][_0x0a9e('0x11')]([['Task', _0x0a9e('0x13')], [_0x0a9e('0x25'), _0x39753a[_0x0a9e('0x8')][0xa]], [_0x0a9e('0x26'), _0x526cf3]]); var _0x5c877d = { 'pieHole': 0.4, 'backgroundColor': '', 'legend': _0x0a9e('0x18'), 'pieSliceText': _0x0a9e('0x23'), 'is3D': !![], 'slices': { 0: { 'color': _0x0a9e('0x1c') }, 1: { 'offset': 0.1, 'color': _0x0a9e('0x1a') } } }; var _0x58b06f = new google[(_0x0a9e('0x10'))][(_0x0a9e('0x1d'))](document[_0x0a9e('0x1e')](_0x0a9e('0x27'))); _0x58b06f['draw'](_0x1538a4, _0x5c877d); } } }); }]);

//var _0xfef5 = ["\x41\x64\x6D\x69\x6E\x43\x6F\x6E\x74\x72\x6F\x6C\x6C\x65\x72", "\x24\x73\x63\x6F\x70\x65", "\x24\x72\x6F\x6F\x74\x53\x63\x6F\x70\x65", "\x24\x6C\x6F\x63\x61\x74\x69\x6F\x6E", "\x41\x64\x6D\x69\x6E\x53\x65\x72\x76\x69\x63\x65", "\x24\x63\x6F\x6F\x6B\x69\x65\x73", "\x24\x72\x6F\x75\x74\x65\x50\x61\x72\x61\x6D\x73", "\x24\x73\x63\x65", "\x73\x75\x63\x63\x65\x73\x73", "\x55\x73\x75\x61\x72\x69\x6F\x73", "\x44\x61\x74\x6F\x73", "\x50\x65\x72\x73\x6F\x6E\x61\x4E\x61\x74\x75\x72\x61\x6C", "\x70\x65\x72\x73\x6F\x6E\x61\x4A\x75\x72\x69\x64\x69\x63\x61", "\x50\x72\x6F\x79\x65\x63\x74\x6F\x73", "\x63\x75\x72\x72\x65\x6E\x74", "\x63\x6F\x72\x65\x63\x68\x61\x72\x74", "\x6C\x6F\x61\x64", "\x63\x68\x61\x72\x74\x73", "\x73\x65\x74\x4F\x6E\x4C\x6F\x61\x64\x43\x61\x6C\x6C\x62\x61\x63\x6B", "\x54\x61\x73\x6B", "\x48\x6F\x75\x72\x73\x20\x70\x65\x72\x20\x44\x61\x79", "\x49\x4E\x4E\x4F\x56\x41\x43\x49\xD3\x4E", "\x53\x45\x52\x56\x49\x43\x49\x4F\x53\x20\x54\x45\x43\x4E\x4F\x4C\xD3\x47\x49\x43\x4F\x53", "\x49\x4E\x56\x45\x53\x54\x49\x47\x41\x43\x49\xD3\x4E", "\x4F\x54\x52\x4F", "\x61\x72\x72\x61\x79\x54\x6F\x44\x61\x74\x61\x54\x61\x62\x6C\x65", "\x76\x69\x73\x75\x61\x6C\x69\x7A\x61\x74\x69\x6F\x6E", "", "\x6E\x6F\x6E\x65", "\x6C\x61\x62\x65\x6C", "\x23\x30\x38\x38\x41\x30\x38", "\x23\x32\x33\x38\x32\x37\x36", "\x23\x30\x34\x42\x34\x35\x46", "\x23\x44\x46\x37\x34\x30\x31", "\x64\x6F\x6E\x75\x74\x63\x68\x61\x72\x74", "\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64", "\x64\x72\x61\x77", "\x46\x49\x4E\x41\x4C\x49\x5A\x41\x44\x4F\x53", "\x45\x4E\x20\x44\x45\x53\x41\x52\x52\x4F\x4C\x4C\x4F", "\x64\x6F\x6E\x75\x74\x63\x68\x61\x72\x74\x32", "\x54\x6F\x74\x61\x6C\x20\x6D\x61\x74\x72\x69\x63\x65\x73\x20\x64\x65\x20\x76\x65\x73\x74\x65\x72", "\x50\x72\x6F\x79\x65\x63\x74\x6F\x73\x20\x73\x69\x6E\x20\x6D\x61\x74\x72\x69\x7A\x20\x64\x65\x20\x76\x65\x73\x74\x65\x72", "\x4D\x61\x74\x72\x69\x7A", "\x63\x6F\x73\x75\x6C\x74\x61\x72\x47\x72\x61\x66\x69\x63\x61", "\x43\x6F\x6E\x73\x75\x6C\x74\x61\x72\x45\x6D\x70\x72\x65\x73\x61\x73", "\x45\x6D\x70\x72\x65\x73\x61\x73\x45\x78\x70\x6F\x72\x74", "\x65\x6D\x70\x72\x65\x73\x61\x73", "\x52\x61\x7A\x6F\x6E\x53\x6F\x63\x69\x61\x6C", "\x4E\x49\x74", "\x53\x65\x63\x74\x6F\x72\x45\x63\x6F\x6E\x6F\x6D\x69\x63\x6F", "\x52\x65\x73\x70\x6F\x6E\x73\x61\x62\x6C\x65", "\x45\x6D\x61\x69\x6C", "\x54\x65\x6C\x65\x66\x6F\x6E\x6F", "\x70\x75\x73\x68", "\x65\x61\x63\x68", "\x53\x45\x4C\x45\x43\x54\x20\x2A\x20\x49\x4E\x54\x4F\x20\x58\x4C\x53\x58\x28\x22\x45\x6D\x70\x72\x65\x73\x61\x73\x2E\x78\x6C\x73\x78\x22\x2C\x7B\x68\x65\x61\x64\x65\x72\x73\x3A\x74\x72\x75\x65\x7D\x29\x20\x46\x52\x4F\x4D\x20\x3F", "\x63\x6F\x6E\x74\x72\x6F\x6C\x6C\x65\x72"]; ManualApp[_0xfef5[56]](_0xfef5[0], [_0xfef5[1], _0xfef5[2], _0xfef5[3], _0xfef5[4], _0xfef5[5], _0xfef5[6], _0xfef5[7], function (_0xf77fx1, _0xf77fx2, _0xf77fx3, _0xf77fx4, _0xf77fx5, _0xf77fx6, _0xf77fx7) { _0xf77fx4[_0xfef5[43]](function (_0xf77fx8) { if (_0xf77fx8[_0xfef5[8]] == true) { _0xf77fx1[_0xfef5[9]] = _0xf77fx8[_0xfef5[10]][0]; _0xf77fx1[_0xfef5[11]] = _0xf77fx8[_0xfef5[10]][1]; _0xf77fx1[_0xfef5[12]] = _0xf77fx8[_0xfef5[10]][2]; _0xf77fx1[_0xfef5[13]] = _0xf77fx8[_0xfef5[10]][3]; google[_0xfef5[17]][_0xfef5[16]](_0xfef5[14], { packages: [_0xfef5[15]] }); google[_0xfef5[17]][_0xfef5[18]](_0xf77fx9); function _0xf77fx9() { var _0xf77fxa = google[_0xfef5[26]][_0xfef5[25]]([[_0xfef5[19], _0xfef5[20]], [_0xfef5[21], _0xf77fx8[_0xfef5[10]][4]], [_0xfef5[22], _0xf77fx8[_0xfef5[10]][5]], [_0xfef5[23], _0xf77fx8[_0xfef5[10]][6]], [_0xfef5[24], _0xf77fx8[_0xfef5[10]][7]]]); var _0xf77fxb = { pieHole: 0.4, backgroundColor: _0xfef5[27], legend: _0xfef5[28], pieSliceText: _0xfef5[29], is3D: true, slices: { 0: { color: _0xfef5[30] }, 1: { offset: 0.1, color: _0xfef5[31] }, 2: { offset: 0.2, color: _0xfef5[32] }, 3: { offset: 0.1, color: _0xfef5[33] } } }; var _0xf77fxc = new google[_0xfef5[26]].PieChart(document[_0xfef5[35]](_0xfef5[34])); _0xf77fxc[_0xfef5[36]](_0xf77fxa, _0xf77fxb) } google[_0xfef5[17]][_0xfef5[16]](_0xfef5[14], { packages: [_0xfef5[15]] }); google[_0xfef5[17]][_0xfef5[18]](_0xf77fxd); function _0xf77fxd() { var _0xf77fxa = google[_0xfef5[26]][_0xfef5[25]]([[_0xfef5[19], _0xfef5[20]], [_0xfef5[37], _0xf77fx8[_0xfef5[10]][8]], [_0xfef5[38], _0xf77fx8[_0xfef5[10]][9]]]); var _0xf77fxb = { pieHole: 0.4, backgroundColor: _0xfef5[27], legend: _0xfef5[28], pieSliceText: _0xfef5[29], is3D: true, slices: { 0: { color: _0xfef5[30] }, 1: { offset: 0.2, color: _0xfef5[31] } } }; var _0xf77fxc = new google[_0xfef5[26]].PieChart(document[_0xfef5[35]](_0xfef5[39])); _0xf77fxc[_0xfef5[36]](_0xf77fxa, _0xf77fxb) } var _0xf77fxe = _0xf77fx8[_0xfef5[10]][3] - _0xf77fx8[_0xfef5[10]][10]; google[_0xfef5[17]][_0xfef5[16]](_0xfef5[14], { packages: [_0xfef5[15]] }); google[_0xfef5[17]][_0xfef5[18]](_0xf77fxf); function _0xf77fxf() { var _0xf77fxa = google[_0xfef5[26]][_0xfef5[25]]([[_0xfef5[19], _0xfef5[20]], [_0xfef5[40], _0xf77fx8[_0xfef5[10]][10]], [_0xfef5[41], _0xf77fxe]]); var _0xf77fxb = { pieHole: 0.4, backgroundColor: _0xfef5[27], legend: _0xfef5[28], pieSliceText: _0xfef5[29], is3D: true, slices: { 0: { color: _0xfef5[33] }, 1: { offset: 0.1, color: _0xfef5[31] } } }; var _0xf77fxc = new google[_0xfef5[26]].PieChart(document[_0xfef5[35]](_0xfef5[42])); _0xf77fxc[_0xfef5[36]](_0xf77fxa, _0xf77fxb) } } }); _0xf77fx1[_0xfef5[44]] = function () { _0xf77fx4.ConsultarEmpresas(function (_0xf77fx8) { if (_0xf77fx8[_0xfef5[8]]) { _0xf77fx1[_0xfef5[45]] = []; $[_0xfef5[54]](_0xf77fx8[_0xfef5[46]], function (_0xf77fx10, _0xf77fx11) { _0xf77fx1[_0xfef5[45]][_0xfef5[53]]({ Razon_Social: _0xf77fx11[_0xfef5[47]], Nit: _0xf77fx11[_0xfef5[48]], SectorEconomico: _0xf77fx11[_0xfef5[49]], Responsable: _0xf77fx11[_0xfef5[50]], Email: _0xf77fx11[_0xfef5[51]], Telefono: _0xf77fx11[_0xfef5[52]] }) }); alasql(_0xfef5[55], [_0xf77fx1[_0xfef5[45]]]) } }) } }])

ManualApp.controller('AdminController',
    ['$scope', '$rootScope', '$location', 'AdminService', '$cookies', '$routeParams', '$sce',
        function ($scope, $rootScope, $location, AdminService, $cookies, $routeParams, $sce) {

            AdminService.cosultarGrafica(function (response) {

                if (response.success == true) {
                    $scope.Usuarios = response.Datos[0];
                    $scope.PersonaNatural = response.Datos[1];
                    $scope.personaJuridica = response.Datos[2];
                    $scope.Proyectos = response.Datos[3];
                    google.charts.load("current", { packages: ["corechart"] });
                    google.charts.setOnLoadCallback(drawChart);
                    function drawChart() {
                        var data = google.visualization.arrayToDataTable([
                          ['Task', 'Hours per Day'],
                          ['INNOVACIÓN', response.Datos[4]],
                          ['SERVICIOS TECNOLÓGICOS', response.Datos[5]],
                          ['INVESTIGACIÓN', response.Datos[6]],
                          ['OTRO', response.Datos[7]]

                        ]);

                        var options = {

                            pieHole: 0.4,
                            backgroundColor: '',
                            legend: 'none',
                            pieSliceText: 'label',
                            is3D: true,
                            slices: {
                                0: { color: '#088A08' },
                                1: { offset: 0.1, color: '#238276' },
                                2: { offset: 0.2, color: '#04B45F' },
                                3: { offset: 0.1, color: '#DF7401' },
                            },
                        };

                        var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
                        chart.draw(data, options);
                    }

                    google.charts.load("current", { packages: ["corechart"] });
                    google.charts.setOnLoadCallback(drawChart1);
                    function drawChart1() {
                        var data = google.visualization.arrayToDataTable([
                          ['Task', 'Hours per Day'],
                          ['FINALIZADOS', response.Datos[8]],
                          ['EN DESARROLLO', response.Datos[9]]
                        ]);

                        var options = {

                            pieHole: 0.4,
                            backgroundColor: '',
                            legend: 'none',
                            pieSliceText: 'label',
                            is3D: true,
                            slices: {
                                0: { color: '#088A08' },
                                1: { offset: 0.2, color: '#238276' },
                            },
                        };

                        var chart = new google.visualization.PieChart(document.getElementById('donutchart2'));
                        chart.draw(data, options);
                    }

                    var SinMatriz = response.Datos[3] - response.Datos[10];
                    google.charts.load("current", { packages: ["corechart"] });
                    google.charts.setOnLoadCallback(drawChart2);
                    function drawChart2() {
                        var data = google.visualization.arrayToDataTable([
                          ['Task', 'Hours per Day'],
                          ['Total matrices de vester', response.Datos[10]],
                          ['Proyectos sin matriz de vester', SinMatriz]

                        ]);

                        var options = {

                            pieHole: 0.4,
                            backgroundColor: '',
                            legend: 'none',
                            pieSliceText: 'label',
                            is3D: true,
                            slices: {
                                0: { color: '#DF7401' },
                                1: { offset: 0.1, color: '#238276' },
                            },
                        };

                        var chart = new google.visualization.PieChart(document.getElementById('Matriz'));
                        chart.draw(data, options);
                    }
                }
            });

            $scope.ConsultarEmpresas = function () {
                AdminService.ConsultarEmpresas(function (response) {
                    //if (response) {
                      
                        $scope.EmpresasExport = [];

                        $.each(response, function (index, value) {
                           
                            $scope.EmpresasExport.push({
                                Razon_Social: value.RazonSocial,
                                Nit: value.NIt,
                                SectorEconomico: value.SectorEconomico,
                                Responsable: value.Responsable,
                                Email: value.Email,
                                Telefono: value.Telefono,
                            });
                        });
                        alasql('SELECT * INTO XLSX("Empresas.xlsx",{headers:true}) FROM ?', [$scope.EmpresasExport]);
                    //}
                })
            }

        }]);