//var _0x347f=['pause','audio-player1','MostrarCronograma','#containerCronograma','show','#audioAyudaOnce','css','display','none','#audioAyudaDiez','agregarCronograma','EL\x20maximo\x20de\x20actividad\x20es\x20de\x2015','warning','push','EliminarCamposCrononograma','length','log','IdCronograma','splice','¿Esta\x20seguro\x20de\x20eliminar\x20la\x20ultima\x20actividad?','#238276','#d33','Si,\x20Eliminar','No,\x20Cancelar!','btn\x20btn-success','btn\x20btn-danger','eliminarItemCronograma','success','Borrado!','se\x20borro\x20la\x20ultima\x20actividad','then','salio\x20mal','Eliminado','El\x20proyecto\x20ha\x20sido\x20eliminado!','error','requestAnimationFrame','mozRequestAnimationFrame','msRequestAnimationFrame','datepicker','EL\x20maximo\x20de\x20items\x20en\x20el\x20presupuesto\x20es\x20de\x2015','25%','EliminarCamposPresupuesto','Item','Concepto','Descripcion','Unidad','Cantidad','ValorUnitario','ValorTotal','each','Actividad','FechaInicio','FechaFin','split','parse','La\x20fecha\x20inicio\x20número:\x20','\x20es\x20mayor\x20a\x20la\x20fecha\x20final','\x20-\x20','toString','Error\x20fechas','La\x20fecha\x20inicio\x20de\x20las\x20posiciones:\x20\x20','\x20sobrepasan\x20la\x20fecha\x20final.','GuardarCronograma','Registro\x20Exitoso','Ups!\x20Faltan\x20campos\x20por\x20completar','AbrirProyecto','Etapa','removeAttr','total','CalcularValorTotal','AIU','0.0','Iva','IvaUtilidad','toFixed','Subtotal','Presupuesto1','IdPresupuesto','EL\x20costo\x20total\x20no\x20puede\x20superar\x20los\x2099.999.999.999\x20millones','IdProyecto','GuardarAIU','/Menu','ConsultarPresupuesto','ConsultarAIU','atras','url','.notify','controller','CronogramaPresupuestoController','$scope','$rootScope','CronogramaPresupuestoService','$cookies','$cookieStore','$routeParams','#containerPresupuesto','hide','#btnPresupuesto','attr','disabled','Cronograma','proyecto','datos','Presupuesto','PauseAudio','getElementById','audio-player'];(function(_0xff1477,_0x25a4e3){var _0x2b182d=function(_0x4af678){while(--_0x4af678){_0xff1477['push'](_0xff1477['shift']());}};_0x2b182d(++_0x25a4e3);}(_0x347f,0xc2));var _0x44ca=function(_0x3f9d04,_0x52e51c){_0x3f9d04=_0x3f9d04-0x0;var _0x2ee1d4=_0x347f[_0x3f9d04];return _0x2ee1d4;};ManualApp[_0x44ca('0x0')](_0x44ca('0x1'),[_0x44ca('0x2'),_0x44ca('0x3'),'$location',_0x44ca('0x4'),_0x44ca('0x5'),_0x44ca('0x6'),'MenuService',_0x44ca('0x7'),'$sce',function(_0x6da0ac,_0x48dd1d,_0x4ea4e9,_0x1aa144,_0x362e7f,_0x5b333f,_0xf627b5,_0x4fb2bd,_0xeb2ef){$(_0x44ca('0x8'))[_0x44ca('0x9')]();$(_0x44ca('0xa'))[_0x44ca('0xb')](_0x44ca('0xc'),'disabled');_0x6da0ac[_0x44ca('0xd')]=[{'IdProyecto':_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],'Actividad':'','FechaInicio':'','FechaFin':''}];_0x6da0ac[_0x44ca('0x10')]=[{'IdProyecto':_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],'Item':'','Concepto':'','Descripcion':'','Unidad':'','Cantidad':'','ValorUnitario':'','ValorTotal':''}];_0x6da0ac['AIU']={'A':'','I':'','U':'','Iva':'','ValorTotal':'','IdProyecto':''};_0x6da0ac[_0x44ca('0x11')]=function(){setTimeout(function(){var _0x4d3d94=document[_0x44ca('0x12')](_0x44ca('0x13'));_0x4d3d94[_0x44ca('0x14')]();},0x3e8);setTimeout(function(){var _0x31e4e6=document[_0x44ca('0x12')](_0x44ca('0x15'));_0x31e4e6[_0x44ca('0x14')]();},0x3e8);};_0x6da0ac[_0x44ca('0x16')]=function(){$(_0x44ca('0x17'))[_0x44ca('0x18')]();$(_0x44ca('0x8'))[_0x44ca('0x9')]();$(_0x44ca('0x19'))[_0x44ca('0x1a')](_0x44ca('0x1b'),_0x44ca('0x1c'));var _0x47688a=document[_0x44ca('0x12')](_0x44ca('0x15'));_0x47688a[_0x44ca('0x14')]();};_0x6da0ac['MostrarPresupuesto']=function(){$('#containerCronograma')[_0x44ca('0x9')]();$('#containerPresupuesto')[_0x44ca('0x18')]();$(_0x44ca('0x1d'))[_0x44ca('0x1a')](_0x44ca('0x1b'),_0x44ca('0x1c'));var _0x20113f=document[_0x44ca('0x12')](_0x44ca('0x13'));_0x20113f[_0x44ca('0x14')]();};_0x6da0ac[_0x44ca('0x1e')]=function(_0x1eba79){if(_0x6da0ac[_0x44ca('0xd')]['length']>=0xf){swal({'text':_0x44ca('0x1f'),'type':_0x44ca('0x20'),'confirmButtonColor':'#238276','width':'25%','allowOutsideClick':![]});return![];}_0x6da0ac[_0x44ca('0xd')][_0x44ca('0x21')]({'IdProyecto':_0x48dd1d[_0x44ca('0xe')]['datos']['id'],'Actividad':'','FechaInicio':'','FechaFin':''});};_0x6da0ac[_0x44ca('0x22')]=function(){if(_0x6da0ac[_0x44ca('0xd')][_0x44ca('0x23')]>0x1){console[_0x44ca('0x24')](_0x6da0ac['Cronograma']);if(_0x6da0ac[_0x44ca('0xd')][_0x6da0ac[_0x44ca('0xd')][_0x44ca('0x23')]-0x1][_0x44ca('0x25')]==undefined){_0x6da0ac['Cronograma'][_0x44ca('0x26')](_0x6da0ac['Cronograma'][_0x44ca('0x23')]-0x1,0x1);}else{swal({'title':'¿Esta\x20seguro?','text':_0x44ca('0x27'),'type':_0x44ca('0x20'),'showCancelButton':!![],'confirmButtonColor':_0x44ca('0x28'),'cancelButtonColor':_0x44ca('0x29'),'confirmButtonText':_0x44ca('0x2a'),'cancelButtonText':_0x44ca('0x2b'),'confirmButtonClass':_0x44ca('0x2c'),'cancelButtonClass':_0x44ca('0x2d')})['then'](function(){_0x1aa144[_0x44ca('0x2e')](_0x6da0ac[_0x44ca('0xd')][_0x6da0ac[_0x44ca('0xd')][_0x44ca('0x23')]-0x1]['IdCronograma'],function(_0x15199f){if(_0x15199f[_0x44ca('0x2f')]){swal({'confirmButtonColor':_0x44ca('0x28'),'title':_0x44ca('0x30'),'text':_0x44ca('0x31'),'type':'success'})[_0x44ca('0x32')](function(){});_0x6da0ac[_0x44ca('0xd')]['splice'](_0x6da0ac[_0x44ca('0xd')]['length']-0x1,0x1);}else{alert(_0x44ca('0x33'));}});}),function(_0x131620){if(_0x131620==='cancel'){swal({'confirmButtonColor':_0x44ca('0x28'),'title':_0x44ca('0x34'),'text':_0x44ca('0x35'),'type':_0x44ca('0x36')});}};}}};var _0x519556=window[_0x44ca('0x37')]||window[_0x44ca('0x38')]||window['webkitRequestAnimationFrame']||window[_0x44ca('0x39')];function _0x2b23d7(){$('.FI')[_0x44ca('0x3a')]({'language':'es','autoclose':!![]});$('.FE')[_0x44ca('0x3a')]({'language':'es','autoclose':!![]});_0x519556(_0x2b23d7);}_0x519556(_0x2b23d7);_0x6da0ac['agregarPresupuesto']=function(){if(_0x6da0ac['Presupuesto'][_0x44ca('0x23')]>=0xe){swal({'text':_0x44ca('0x3b'),'type':_0x44ca('0x20'),'confirmButtonColor':_0x44ca('0x28'),'width':_0x44ca('0x3c'),'allowOutsideClick':![]});return![];}_0x6da0ac[_0x44ca('0x10')][_0x44ca('0x21')]({'IdProyecto':_0x48dd1d['proyecto'][_0x44ca('0xf')]['id'],'Item':'','Concepto':'','Descripcion':'','Unidad':'','Cantidad':'','ValorUnitario':'','ValorTotal':''});};_0x6da0ac[_0x44ca('0x3d')]=function(){if(_0x6da0ac[_0x44ca('0x10')][_0x6da0ac[_0x44ca('0x10')][_0x44ca('0x23')]-0x1][_0x44ca('0x3e')]==''&&_0x6da0ac[_0x44ca('0x10')][_0x6da0ac[_0x44ca('0x10')][_0x44ca('0x23')]-0x1][_0x44ca('0x3f')]==''&&_0x6da0ac[_0x44ca('0x10')][_0x6da0ac[_0x44ca('0x10')]['length']-0x1][_0x44ca('0x40')]==''&&_0x6da0ac[_0x44ca('0x10')][_0x6da0ac['Presupuesto']['length']-0x1][_0x44ca('0x41')]==''&&_0x6da0ac['Presupuesto'][_0x6da0ac['Presupuesto']['length']-0x1][_0x44ca('0x42')]==''&&_0x6da0ac[_0x44ca('0x10')][_0x6da0ac[_0x44ca('0x10')][_0x44ca('0x23')]-0x1][_0x44ca('0x43')]==''&&_0x6da0ac['Presupuesto'][_0x6da0ac[_0x44ca('0x10')][_0x44ca('0x23')]-0x1][_0x44ca('0x44')]==''){if(_0x6da0ac['Presupuesto'][_0x44ca('0x23')]>0x1){_0x6da0ac[_0x44ca('0x10')]['splice'](_0x6da0ac[_0x44ca('0x10')][_0x44ca('0x23')]-0x1,0x1);}}};_0x6da0ac['GuardarCronograma']=function(){var _0xb55fa8=0x0;var _0x50bbb6='';var _0x52c750='';$[_0x44ca('0x45')](_0x6da0ac[_0x44ca('0xd')],function(_0x2620ac,_0x25da9e){_0x50bbb6+=_0x25da9e[_0x44ca('0x46')];if(_0x25da9e[_0x44ca('0x46')]==''||_0x25da9e['FechaInicio']==''||_0x25da9e['FechaFin']==''){_0xb55fa8++;}else{var _0x815c75=_0x25da9e[_0x44ca('0x47')]['split']('/');var _0x1ebf58=_0x25da9e[_0x44ca('0x48')][_0x44ca('0x49')]('/');var _0x5b2f4b=_0x815c75[0x1]+'-'+_0x815c75[0x2]+'-'+_0x815c75[0x0];var _0x494357=_0x1ebf58[0x1]+'-'+_0x1ebf58[0x2]+'-'+_0x1ebf58[0x0];if(Date[_0x44ca('0x4a')](_0x5b2f4b)>Date[_0x44ca('0x4a')](_0x494357)){swal({'text':_0x44ca('0x4b')+(_0x2620ac+0x1)+_0x44ca('0x4c'),'confirmButtonColor':_0x44ca('0x28'),'width':_0x44ca('0x3c'),'allowOutsideClick':![]});_0x52c750+=_0x44ca('0x4d')+(_0x2620ac+0x1)[_0x44ca('0x4e')]()+'\x0a';}}});if(_0xb55fa8==0x0){if(_0x52c750!=''){swal({'title':_0x44ca('0x4f'),'text':_0x44ca('0x50')+_0x52c750+_0x44ca('0x51'),'confirmButtonColor':_0x44ca('0x28'),'width':'25%','allowOutsideClick':![]});return![];}waitingDialog[_0x44ca('0x18')]();_0x1aa144[_0x44ca('0x52')](_0x6da0ac['Cronograma'],function(_0x49b302){if(_0x49b302[_0x44ca('0x2f')]){waitingDialog[_0x44ca('0x9')]();swal({'text':_0x44ca('0x53'),'confirmButtonColor':'#238276','width':'25%'});$(_0x44ca('0xa'))['removeAttr'](_0x44ca('0xc'),_0x44ca('0xc'));$(_0x44ca('0x8'))[_0x44ca('0x18')]();$(_0x44ca('0x17'))[_0x44ca('0x9')]();}});}else{alertify[_0x44ca('0x2f')](_0x44ca('0x54'));return;}};_0x1aa144[_0x44ca('0x55')](_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],function(_0x36421f){waitingDialog[_0x44ca('0x18')]();if(_0x36421f[_0x44ca('0x2f')]){_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')][_0x44ca('0x56')]=_0x36421f[_0x44ca('0xe')][_0x44ca('0x56')];if(_0x48dd1d[_0x44ca('0xe')]['datos'][_0x44ca('0x56')]>=0x9){$(_0x44ca('0xa'))[_0x44ca('0x57')](_0x44ca('0xc'),_0x44ca('0xc'));_0x1aa144['ConsultarCronograma'](_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],function(_0x1d4f6a){if(_0x1d4f6a[_0x44ca('0x2f')]){_0x6da0ac[_0x44ca('0xd')]=_0x1d4f6a['Cronograma'];console[_0x44ca('0x24')](_0x6da0ac[_0x44ca('0xd')]);}});}waitingDialog[_0x44ca('0x9')]();}});_0x6da0ac[_0x44ca('0x58')]=0x0;_0x6da0ac[_0x44ca('0x59')]=function(){_0x6da0ac[_0x44ca('0x58')]=0x0;$[_0x44ca('0x45')](_0x6da0ac['Presupuesto'],function(_0x47cf6e,_0x258526){_0x258526[_0x44ca('0x44')]=_0x258526[_0x44ca('0x42')]*_0x258526['ValorUnitario'];_0x6da0ac['total']=_0x258526['ValorTotal']+_0x6da0ac[_0x44ca('0x58')];});var _0x23a477=0x1;var _0x4e24aa=0x1;var _0x59ee3e=0x1;var _0x567d7a=0x1;var _0x32e9c6=0x1;var _0x5e3826=0x1;if(parseFloat(_0x6da0ac[_0x44ca('0x5a')]['A'])<0xa){_0x4e24aa=_0x44ca('0x5b')+_0x6da0ac[_0x44ca('0x5a')]['A'];_0x567d7a=parseFloat(_0x4e24aa)*_0x6da0ac[_0x44ca('0x58')];}else{_0x4e24aa='0.'+_0x6da0ac[_0x44ca('0x5a')]['A'];_0x567d7a=parseFloat(_0x4e24aa)*_0x6da0ac['total'];}if(parseFloat(_0x6da0ac[_0x44ca('0x5a')]['I'])<0xa){_0x59ee3e=_0x44ca('0x5b')+_0x6da0ac[_0x44ca('0x5a')]['I'];_0x5e3826=parseFloat(_0x59ee3e)*_0x6da0ac[_0x44ca('0x58')];}else{_0x59ee3e='0.'+_0x6da0ac['AIU']['I'];_0x5e3826=parseFloat(_0x59ee3e)*_0x6da0ac['total'];}if(parseFloat(_0x6da0ac[_0x44ca('0x5a')]['U'])<0xa){_0x23a477='0.0'+_0x6da0ac['AIU']['U'];_0x32e9c6=parseFloat(_0x23a477)*_0x6da0ac[_0x44ca('0x58')];}else{_0x23a477='0.'+_0x6da0ac[_0x44ca('0x5a')]['U'];_0x32e9c6=parseFloat(_0x23a477)*_0x6da0ac['total'];}if(parseFloat(_0x6da0ac[_0x44ca('0x5a')][_0x44ca('0x5c')])<0xa){ivaString=_0x44ca('0x5b')+_0x6da0ac['AIU'][_0x44ca('0x5c')];iva=parseFloat(ivaString)*_0x32e9c6;_0x6da0ac[_0x44ca('0x5d')]=iva;if(_0x6da0ac[_0x44ca('0x5d')]==0x0){_0x6da0ac[_0x44ca('0x5a')][_0x44ca('0x5c')]='';}else{_0x6da0ac['IvaUtilidad']=iva;}}else{ivaString='0.'+_0x6da0ac[_0x44ca('0x5a')][_0x44ca('0x5c')];iva=parseFloat(ivaString)*_0x32e9c6;_0x6da0ac[_0x44ca('0x5d')]=iva;if(_0x6da0ac['IvaUtilidad']==0x0){_0x6da0ac[_0x44ca('0x5a')][_0x44ca('0x5c')]='';}else{_0x6da0ac[_0x44ca('0x5d')]=iva;}}_0x6da0ac['A']=_0x567d7a[_0x44ca('0x5e')](0x2);_0x6da0ac['I']=_0x5e3826[_0x44ca('0x5e')](0x2);_0x6da0ac['U']=_0x32e9c6[_0x44ca('0x5e')](0x2);_0x6da0ac[_0x44ca('0x5f')]=_0x6da0ac['total'][_0x44ca('0x5e')](0x2);_0x6da0ac[_0x44ca('0x58')]=(_0x6da0ac[_0x44ca('0x58')]+_0x567d7a+_0x5e3826+_0x32e9c6)[_0x44ca('0x5e')](0x2);};_0x6da0ac['GuardarPresupuesto']=function(){_0x6da0ac[_0x44ca('0x60')]=[];var _0xb048ab=0x0;$[_0x44ca('0x45')](_0x6da0ac['Presupuesto'],function(_0x1d56da,_0xbd6c6c){if(_0xbd6c6c[_0x44ca('0x3e')]==''||_0xbd6c6c[_0x44ca('0x3f')]==''||_0xbd6c6c[_0x44ca('0x40')]==''||_0xbd6c6c[_0x44ca('0x41')]==''){alertify['success'](_0x44ca('0x54'));_0xb048ab++;}_0x6da0ac[_0x44ca('0x60')]['push']({'IdProyecto':_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],'IdPresupuesto':_0xbd6c6c[_0x44ca('0x61')],'Item':_0xbd6c6c[_0x44ca('0x3e')],'Concepto':_0xbd6c6c[_0x44ca('0x3f')],'Descripcion':_0xbd6c6c[_0x44ca('0x40')],'Unidad':_0xbd6c6c[_0x44ca('0x41')],'Cantidad':_0xbd6c6c['Cantidad'],'ValorUnitario':_0xbd6c6c[_0x44ca('0x43')]});});if(_0xb048ab==0x0){if(_0x6da0ac['total']>0x174876e7ff){swal({'text':_0x44ca('0x62'),'confirmButtonColor':_0x44ca('0x28'),'width':_0x44ca('0x3c')});return![];}waitingDialog[_0x44ca('0x18')]();_0x1aa144['GuardarPresupuesto'](_0x6da0ac[_0x44ca('0x60')],function(_0x17c0ec){if(_0x17c0ec[_0x44ca('0x2f')]){_0x6da0ac['AIU'][_0x44ca('0x44')]=_0x6da0ac[_0x44ca('0x58')];_0x6da0ac[_0x44ca('0x5a')][_0x44ca('0x63')]=_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'];_0x1aa144[_0x44ca('0x64')](_0x6da0ac[_0x44ca('0x5a')],function(_0x2d036f){if(_0x2d036f[_0x44ca('0x2f')]){waitingDialog['hide']();swal({'text':_0x44ca('0x53'),'confirmButtonColor':_0x44ca('0x28'),'width':_0x44ca('0x3c')});_0x4ea4e9['url'](_0x44ca('0x65'));}});}});}};_0x1aa144['AbrirProyecto'](_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],function(_0x4a6589){if(_0x4a6589[_0x44ca('0x2f')]){waitingDialog[_0x44ca('0x18')]();_0x48dd1d['proyecto'][_0x44ca('0xf')]['Etapa']=_0x4a6589['proyecto'][_0x44ca('0x56')];if(_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')][_0x44ca('0x56')]>=0xa){_0x1aa144[_0x44ca('0x66')](_0x48dd1d[_0x44ca('0xe')][_0x44ca('0xf')]['id'],function(_0x2fe8fb){if(_0x2fe8fb[_0x44ca('0x2f')]){_0x6da0ac[_0x44ca('0x58')]=0x0;_0x6da0ac[_0x44ca('0x10')]=_0x2fe8fb[_0x44ca('0x10')];$[_0x44ca('0x45')](_0x6da0ac['Presupuesto'],function(_0x20dd36,_0x56997f){_0x56997f[_0x44ca('0x44')]=_0x56997f['Cantidad']*_0x56997f[_0x44ca('0x43')];_0x6da0ac['total']=_0x56997f[_0x44ca('0x44')]+_0x6da0ac['total'];_0x6da0ac[_0x44ca('0x10')][_0x20dd36][_0x44ca('0x3e')]=parseFloat(_0x56997f[_0x44ca('0x3e')]);});_0x1aa144[_0x44ca('0x67')](_0x48dd1d['proyecto'][_0x44ca('0xf')]['id'],function(_0x559ea1){if(_0x559ea1['success']){_0x6da0ac[_0x44ca('0x5a')]=_0x559ea1['AIU'];_0x6da0ac[_0x44ca('0x59')]();}});}waitingDialog[_0x44ca('0x9')]();});}waitingDialog[_0x44ca('0x9')]();}});_0x6da0ac[_0x44ca('0x68')]=function(){_0x4ea4e9[_0x44ca('0x69')](_0x44ca('0x65'));$(_0x44ca('0x6a'))[_0x44ca('0x9')]();};}]);
ManualApp.controller('CronogramaPresupuestoController',
    ['$scope', '$rootScope', '$location', 'CronogramaPresupuestoService', '$cookies', '$cookieStore', 'MenuService', '$routeParams', '$sce',
        function ($scope, $rootScope, $location, CronogramaPresupuestoService, $cookies, $cookieStore, MenuService, $routeParams, $sce) {

            $("#containerPresupuesto").hide();
            $("#btnPresupuesto").attr("disabled", "disabled");
         

            $scope.Cronograma = [{
                IdProyecto: $rootScope.proyecto.datos.id,
                Actividad: "",
                FechaInicio: "",
                FechaFin: ""
            }]

            $scope.Presupuesto = [{
                IdProyecto: $rootScope.proyecto.datos.id,
                Item: "",
                Concepto: "",
                Descripcion: "",
                Unidad: "",
                Cantidad: "",
                ValorUnitario: "",
                ValorTotal: ""

            }]

            $scope.AIU = {
                A: "",
                I: "",
                U: "",
                Iva: "",
                ValorTotal: "",
                IdProyecto: ""
            }

            $scope.PauseAudio = function () {
                setTimeout(function () {
                    var audio = document.getElementById("audio-player");
                    audio.pause();
                }, 1000);

                setTimeout(function () {
                    var audio = document.getElementById("audio-player1");
                    audio.pause();
                }, 1000);
            }

           
            $scope.MostrarCronograma = function () {
                $("#containerCronograma").show();
                $("#containerPresupuesto").hide();
                $('#audioAyudaOnce').css("display", "none");
                var audio1 = document.getElementById("audio-player1");
                audio1.pause();
            }

            $scope.MostrarPresupuesto = function () {
                $("#containerCronograma").hide();
                $("#containerPresupuesto").show();
                $('#audioAyudaDiez').css("display", "none");
                var audio = document.getElementById("audio-player");
                audio.pause();
            }

            $scope.agregarCronograma = function (index) {

                //$("#FechaInicio0").remove();
                if ($scope.Cronograma.length >= 15) {
                    swal({
                        text: 'EL maximo de actividad es de 15',
                        type: 'warning',
                        confirmButtonColor: '#238276',
                        width: '25%',
                        allowOutsideClick: false

                    })
                    return false;
                }

                $scope.Cronograma.push({
                    IdProyecto: $rootScope.proyecto.datos.id,
                    Actividad: "",
                    FechaInicio: "",
                    FechaFin: ""
                })
            }

            $scope.EliminarCamposCrononograma = function () {
                   



                if ($scope.Cronograma.length > 1) {
                    console.log($scope.Cronograma);
                    if ($scope.Cronograma[$scope.Cronograma.length - 1].IdCronograma == undefined) {
                        $scope.Cronograma.splice(($scope.Cronograma.length - 1), 1);
                    } else {
                        swal({
                            title: '¿Esta seguro?',
                            text: "¿Esta seguro de eliminar la ultima actividad?",
                            type: 'warning',
                            showCancelButton: true,
                            confirmButtonColor: '#238276',
                            cancelButtonColor: '#d33',
                            confirmButtonText: 'Si, Eliminar',
                            cancelButtonText: 'No, Cancelar!',
                            confirmButtonClass: 'btn btn-success',
                            cancelButtonClass: 'btn btn-danger',
                            //preConfirm: function () {

                            //}

                        }).then(function () {
                            CronogramaPresupuestoService.eliminarItemCronograma( $scope.Cronograma[$scope.Cronograma.length -1 ].IdCronograma, function (response) {
                                if (response.success) {
                                    swal({

                                        confirmButtonColor: '#238276',
                                        title: 'Borrado!',
                                        text: 'se borro la ultima actividad',
                                        type: 'success'
                                    }).then(function () {
                                    })

                                    $scope.Cronograma.splice(($scope.Cronograma.length - 1), 1);
                                   
                                } else {
                                    alert("salio mal");
                                }
                            })
                        }), function (dismiss) {
                            // dismiss can be 'cancel', 'overlay',
                            // 'close', and 'timer'
                            if (dismiss === 'cancel') {
                                swal({
                                    confirmButtonColor: '#238276',
                                    title: 'Eliminado',
                                    text: 'El proyecto ha sido eliminado!',
                                    type: 'error',
                                })
                            }
                        }
                    }

                }

                
               

            };

            var update = window.requestAnimationFrame || window.mozRequestAnimationFrame ||
                        window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

            function repetir() {
               
                $('.FI').datepicker({
                    language: 'es',
                    autoclose: true,
                   
                    //daysOfWeekDisabled: [0]
                });

                $('.FE').datepicker({
                    language: 'es',
                    autoclose: true,
                    //daysOfWeekDisabled: [0]
                });


                update(repetir); //entra en la funcion repetir sin salir de la misma, asi crea un ciclo infinito
            }
            update(repetir);

            $scope.agregarPresupuesto = function () {
                if ($scope.Presupuesto.length >= 14) {
                    swal({
                        text: 'EL maximo de items en el presupuesto es de 15',
                        type: 'warning',
                        confirmButtonColor: '#238276',
                        width: '25%',
                        allowOutsideClick: false

                    })
                    return false;
                }
            
                $scope.Presupuesto.push({
                    IdProyecto: $rootScope.proyecto.datos.id,
                    Item: "",
                    Concepto: "",
                    Descripcion: "",
                    Unidad: "",
                    Cantidad: "",
                    ValorUnitario: "",
                    ValorTotal: ""
                })

            }

            $scope.EliminarCamposPresupuesto = function () {

                if ($scope.Presupuesto[($scope.Presupuesto.length - 1)].Item == "" && $scope.Presupuesto[($scope.Presupuesto.length - 1)].Concepto == ""
                    && $scope.Presupuesto[($scope.Presupuesto.length - 1)].Descripcion == "" && $scope.Presupuesto[($scope.Presupuesto.length - 1)].Unidad == ""
                     && $scope.Presupuesto[($scope.Presupuesto.length - 1)].Cantidad == "" && $scope.Presupuesto[($scope.Presupuesto.length - 1)].ValorUnitario == "" && $scope.Presupuesto[($scope.Presupuesto.length - 1)].ValorTotal == "") {

                    if ($scope.Presupuesto.length > 1) {
                        $scope.Presupuesto.splice(($scope.Presupuesto.length - 1), 1);
                    }
                }

            };

            $scope.GuardarCronograma = function () {
                var cont = 0;
                var cantidadString = "";
                var errorFechas = "";
                $.each($scope.Cronograma, function (index, value) {
                    cantidadString += value.Actividad;
                    if (value.Actividad == "" || value.FechaInicio == "" || value.FechaFin == "" ) {
                        cont++;
                    } else {
                        var x = value.FechaInicio.split('/');
                        var y = value.FechaFin.split('/');
                        var StartDate = x[1] + "-" + x[2] + "-" + x[0];
                        var EndDate = y[1] + "-" + y[2] + "-" + y[0];
                        if (Date.parse(StartDate) > Date.parse(EndDate)) {
                            swal({
                                text: 'La fecha inicio número: ' + (index+1) + ' es mayor a la fecha final',
                                confirmButtonColor: '#238276',
                                width: '25%',
                                allowOutsideClick: false
                            })
                            errorFechas += ' - ' + (index + 1).toString() + '\n';
                        }
                    }
                })
                if (cont == 0) {
                    //if (errorFechas.length > 15) {
                    //    swal({
                    //        text: 'EL maximo de actividad es de 15',
                    //        type: 'warning',
                    //        confirmButtonColor: '#238276',
                    //        width: '25%',
                    //        allowOutsideClick: false

                    //    })
                    //    return false;
                    //}
                    if (errorFechas!="") {
                        swal({
                            title:'Error fechas',
                            text: "La fecha inicio de las posiciones:  " + errorFechas + " sobrepasan la fecha final.",
                            confirmButtonColor: '#238276',
                            width: '25%',
                            allowOutsideClick: false

                        })
                        return false;
                    }
                    waitingDialog.show();
                    
                    CronogramaPresupuestoService.GuardarCronograma($scope.Cronograma, function (response) {
                        if (response.success) {
                            waitingDialog.hide();
                            swal({
                                text: 'Registro Exitoso',
                                confirmButtonColor: '#238276',
                                width: '25%'
                            })
                            $("#btnPresupuesto").removeAttr("disabled", "disabled");
                            $("#containerPresupuesto").show();
                            $("#containerCronograma").hide();
                        }
                    })
                } else {
                    alertify.success("Ups! Faltan campos por completar");
                    return;
                }
            }

            CronogramaPresupuestoService.AbrirProyecto($rootScope.proyecto.datos.id, function (response) {
                
                waitingDialog.show();
                if (response.success) {
                    $rootScope.proyecto.datos.Etapa = response.proyecto.Etapa;

                    if ($rootScope.proyecto.datos.Etapa >= 9) {
                        $("#btnPresupuesto").removeAttr("disabled", "disabled");
                        CronogramaPresupuestoService.ConsultarCronograma($rootScope.proyecto.datos.id, function (response) {

                            if (response.success) {
                                $scope.Cronograma = response.Cronograma;
                                console.log($scope.Cronograma)

                            }

                        })
                    }
                    waitingDialog.hide();
                }
            })

            $scope.total = 0;

            $scope.CalcularValorTotal = function () {
                //$scope.Presupuesto[0].ValorTotal = $scope.Presupuesto[0].Cantidad * $scope.Presupuesto[0].ValorUnitario;
            
                $scope.total = 0;
                $.each($scope.Presupuesto, function (index, value) {
                    value.ValorTotal = value.Cantidad * value.ValorUnitario;
                    $scope.total = value.ValorTotal + $scope.total;
                })

                var u = 1;
                var a = 1;
                var i = 1;
                var A = 1;
                var U = 1;
                var I = 1;


                if (parseFloat($scope.AIU.A) < 10) {

                    a = "0.0" + ($scope.AIU.A);
                    A = parseFloat(a) * $scope.total;

                } else {

                    a = "0." + ($scope.AIU.A);
                    A = parseFloat(a) * $scope.total;
                }

                if (parseFloat($scope.AIU.I) < 10) {

                    i = "0.0" + ($scope.AIU.I);
                    I = parseFloat(i) * $scope.total;

                } else {
                    i = "0." + ($scope.AIU.I);
                    I = parseFloat(i) * $scope.total;
                }


                if (parseFloat($scope.AIU.U) < 10) {

                    u = "0.0" + ($scope.AIU.U);
                    U = parseFloat(u) * $scope.total;

                } else {
                    u = "0." + ($scope.AIU.U);
                    U = parseFloat(u) * $scope.total;
                }

                if (parseFloat($scope.AIU.Iva) < 10) {

                    ivaString = "0.0" + ($scope.AIU.Iva);
                    iva = parseFloat(ivaString) * U;
                    $scope.IvaUtilidad = iva;
                    if ($scope.IvaUtilidad == 0) {
                        $scope.AIU.Iva = "";
                    } else {
                        $scope.IvaUtilidad = iva;
                    }
                   
                } else {
                    ivaString = "0." + ($scope.AIU.Iva);
                    iva = parseFloat(ivaString) * U;
                    $scope.IvaUtilidad = iva;
                   
                    if ($scope.IvaUtilidad == 0) {
                        $scope.AIU.Iva = "";
                } else {
                        $scope.IvaUtilidad = iva;
            }
                }

                $scope.A = A.toFixed(2);
                $scope.I = I.toFixed(2);
                $scope.U = U.toFixed(2);
                $scope.Subtotal = $scope.total.toFixed(2);
                $scope.total = ($scope.total + A + I + U).toFixed(2);

               

            }

            $scope.GuardarPresupuesto = function () {
                $scope.Presupuesto1 = [];

                var contador1 = 0;
                $.each($scope.Presupuesto, function (index, value) {
                   
                    if (value.Item == "" || value.Concepto == "" || value.Descripcion == "" || value.Unidad=="") {
                        alertify.success("Ups! Faltan campos por completar");
                        contador1++;
                    }
                  
                    $scope.Presupuesto1.push({
                        IdProyecto: $rootScope.proyecto.datos.id,
                        IdPresupuesto: value.IdPresupuesto,
                        Item: value.Item,
                        Concepto: value.Concepto,
                        Descripcion: value.Descripcion,
                        Unidad: value.Unidad,
                        Cantidad: value.Cantidad,
                        ValorUnitario: value.ValorUnitario

                    })

                })

               
                if (contador1 == 0) {
                    if ($scope.total > 99999999999) {
                        swal({
                            text: 'EL costo total no puede superar los 99.999.999.999 millones',
                            confirmButtonColor: '#238276',
                            width: '25%'

                        })

                        return false;
                    }
                    waitingDialog.show();
                    CronogramaPresupuestoService.GuardarPresupuesto($scope.Presupuesto1, function (response) {
                        if (response.success) {

                            $scope.AIU.ValorTotal = $scope.total;
                            $scope.AIU.IdProyecto = $rootScope.proyecto.datos.id;

                            CronogramaPresupuestoService.GuardarAIU($scope.AIU, function (response) {
                                if (response.success) {

                                    waitingDialog.hide();
                                    swal({

                                        text: 'Registro Exitoso',
                                        confirmButtonColor: '#238276',
                                        width: '25%'

                                    })

                                    $location.url("/Menu");

                                }
                            })
                        }
                    })
                }
                
            }

            CronogramaPresupuestoService.AbrirProyecto($rootScope.proyecto.datos.id, function (response) {
                if (response.success) {
                    waitingDialog.show();
                    $rootScope.proyecto.datos.Etapa = response.proyecto.Etapa;

                    if ($rootScope.proyecto.datos.Etapa >= 10) {

                        CronogramaPresupuestoService.ConsultarPresupuesto($rootScope.proyecto.datos.id, function (response) {
                            if (response.success) {
                                $scope.total = 0;
                                //$scope.Presupuesto = [];

                                
                                $scope.Presupuesto = response.Presupuesto;
                                $.each($scope.Presupuesto, function (index, value) {
                                    value.ValorTotal = value.Cantidad * value.ValorUnitario;
                                    $scope.total = value.ValorTotal + $scope.total;
                                    $scope.Presupuesto[index].Item = parseFloat(value.Item);
                                })

                                CronogramaPresupuestoService.ConsultarAIU($rootScope.proyecto.datos.id, function (response) {
                                    if (response.success) {

                                        $scope.AIU = response.AIU;
                                        //$scope.total = $scope.AIU.ValorTotal;
                                        $scope.CalcularValorTotal();

                                    }

                                })

                            }
                            waitingDialog.hide();
                        })



                    }
                    waitingDialog.hide();
                }
            })

            $scope.atras = function () {

                $location.url("/Menu");
                $(".notify").hide();

            }



        }]);